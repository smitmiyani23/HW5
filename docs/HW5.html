<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ST558 HW5: Non-Linear</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ST558 HW5: Non-Linear</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="document-details" class="level1">
<h1>Document Details</h1>
<section id="author-smit-miyani" class="level4">
<h4 class="anchored" data-anchor-id="author-smit-miyani">Author: <em>Smit Miyani</em></h4>
</section>
<section id="collaborators-na" class="level4">
<h4 class="anchored" data-anchor-id="collaborators-na">Collaborators: <em>N/A</em></h4>
</section>
<section id="assignment-hw5" class="level4">
<h4 class="anchored" data-anchor-id="assignment-hw5">Assignment: <em>HW5</em></h4>
</section>
<section id="date-15jul24" class="level4">
<h4 class="anchored" data-anchor-id="date-15jul24">Date: <em>15JUl24</em></h4>
</section>
<section id="purpose" class="level4">
<h4 class="anchored" data-anchor-id="purpose">Purpose</h4>
<p><em>General practice in modelling data.</em></p>
</section>
</section>
<section id="tasks" class="level1">
<h1>Tasks</h1>
<section id="task-1-conceptual-questions" class="level2">
<h2 class="anchored" data-anchor-id="task-1-conceptual-questions">Task 1: Conceptual Questions</h2>
<ol type="1">
<li><p>What is the purpose of using cross-validation when fitting a random forest model??</p>
<blockquote class="blockquote">
<p>The purpose of using cross-validation when fitting a RF model is to evaluate how well the model performs on unseen data multiple times. By splitting the data into several parts and training the model multiple times, each time using a different part for validation, we can get a more accurate measure of the model’s performance and reduce the risk of overfitting.</p>
</blockquote></li>
<li><p>Describe the bagged tree algorithm.</p>
<blockquote class="blockquote">
<p>The bagged tree algorithm involves creating multiple decision trees using different random subsets of the training data. Each tree is trained independently, and the final prediction is made by averaging/taking majority of the predictions of all the trees, which helps to improve the model’s accuracy and stability by reducing variance.</p>
</blockquote></li>
<li><p>What is meant by a general linear model?</p>
<blockquote class="blockquote">
<p>A general linear model is a statistical model that describes the relationship between a dependent variable and one or more independent variables using a linear equation. It can be used to predict outcomes and understand relationships between variables.</p>
</blockquote></li>
<li><p>When fitting a multiple linear regression model, what does adding an interaction term do? That is, what does it allow the model to do differently as compared to when it is not included in the model?</p>
<blockquote class="blockquote">
<p>Adding an interaction term in a MLR model allows the model to account for the combined effect of two or more variables on the dependent variable. This means the model can analyze situations where the effect of one variable on the response depends on the level of another variable, providing a more complex understanding of the relationships between variables.</p>
</blockquote></li>
<li><p>Why do we split our data into a training and test set?</p>
<blockquote class="blockquote">
<p>We split our data into a training and test set to check how well our model performs on new, unseen data. The training set is used to create and train the model, while the test set is used to evaluate its prediction performance. This helps to ensure that the model generalizes well and is not just memorizing the training data.</p>
</blockquote></li>
</ol>
</section>
<section id="task-2-fitting-models" class="level2">
<h2 class="anchored" data-anchor-id="task-2-fitting-models">Task 2: Fitting Models</h2>
<p>Loading required modelling and summarizing packages and reading <code>heart.csv</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>heart_data<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://www4.stat.ncsu.edu/~online/datasets/heart.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="quick-edadata-preparation" class="level3">
<h3 class="anchored" data-anchor-id="quick-edadata-preparation">Quick EDA/Data Preparation</h3>
<section id="question-1-summarizing-heart_data" class="level4">
<h4 class="anchored" data-anchor-id="question-1-summarizing-heart_data">Question 1: Summarizing <code>heart_data</code></h4>
<p>Looking at the structure of data using str().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(heart_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [918 × 12] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Age           : num [1:918] 40 49 37 48 54 39 45 54 37 48 ...
 $ Sex           : chr [1:918] "M" "F" "M" "F" ...
 $ ChestPainType : chr [1:918] "ATA" "NAP" "ATA" "ASY" ...
 $ RestingBP     : num [1:918] 140 160 130 138 150 120 130 110 140 120 ...
 $ Cholesterol   : num [1:918] 289 180 283 214 195 339 237 208 207 284 ...
 $ FastingBS     : num [1:918] 0 0 0 0 0 0 0 0 0 0 ...
 $ RestingECG    : chr [1:918] "Normal" "Normal" "ST" "Normal" ...
 $ MaxHR         : num [1:918] 172 156 98 108 122 170 170 142 130 120 ...
 $ ExerciseAngina: chr [1:918] "N" "N" "N" "Y" ...
 $ Oldpeak       : num [1:918] 0 1 0 1.5 0 0 0 0 1.5 0 ...
 $ ST_Slope      : chr [1:918] "Up" "Flat" "Up" "Flat" ...
 $ HeartDisease  : num [1:918] 0 1 0 1 0 0 0 0 1 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   Age = col_double(),
  ..   Sex = col_character(),
  ..   ChestPainType = col_character(),
  ..   RestingBP = col_double(),
  ..   Cholesterol = col_double(),
  ..   FastingBS = col_double(),
  ..   RestingECG = col_character(),
  ..   MaxHR = col_double(),
  ..   ExerciseAngina = col_character(),
  ..   Oldpeak = col_double(),
  ..   ST_Slope = col_character(),
  ..   HeartDisease = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>Summary of data using <code>summary()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Age            Sex            ChestPainType        RestingBP    
 Min.   :28.00   Length:918         Length:918         Min.   :  0.0  
 1st Qu.:47.00   Class :character   Class :character   1st Qu.:120.0  
 Median :54.00   Mode  :character   Mode  :character   Median :130.0  
 Mean   :53.51                                         Mean   :132.4  
 3rd Qu.:60.00                                         3rd Qu.:140.0  
 Max.   :77.00                                         Max.   :200.0  
  Cholesterol      FastingBS       RestingECG            MaxHR      
 Min.   :  0.0   Min.   :0.0000   Length:918         Min.   : 60.0  
 1st Qu.:173.2   1st Qu.:0.0000   Class :character   1st Qu.:120.0  
 Median :223.0   Median :0.0000   Mode  :character   Median :138.0  
 Mean   :198.8   Mean   :0.2331                      Mean   :136.8  
 3rd Qu.:267.0   3rd Qu.:0.0000                      3rd Qu.:156.0  
 Max.   :603.0   Max.   :1.0000                      Max.   :202.0  
 ExerciseAngina        Oldpeak          ST_Slope          HeartDisease   
 Length:918         Min.   :-2.6000   Length:918         Min.   :0.0000  
 Class :character   1st Qu.: 0.0000   Class :character   1st Qu.:0.0000  
 Mode  :character   Median : 0.6000   Mode  :character   Median :1.0000  
                    Mean   : 0.8874                      Mean   :0.5534  
                    3rd Qu.: 1.5000                      3rd Qu.:1.0000  
                    Max.   : 6.2000                      Max.   :1.0000  </code></pre>
</div>
</div>
<p>Looking for missing data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Missing values in each column</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(heart_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Age            Sex  ChestPainType      RestingBP    Cholesterol 
             0              0              0              0              0 
     FastingBS     RestingECG          MaxHR ExerciseAngina        Oldpeak 
             0              0              0              0              0 
      ST_Slope   HeartDisease 
             0              0 </code></pre>
</div>
</div>
</section>
<section id="question-2-removing-the-st_slope-column-and-converting-heartdisease-to-factor" class="level4">
<h4 class="anchored" data-anchor-id="question-2-removing-the-st_slope-column-and-converting-heartdisease-to-factor">Question 2: Removing the <code>ST_Slope</code> column and converting <code>HeartDisease</code> to factor</h4>
<p>Removing the <code>ST_Slope</code> column as instructed using <code>select()</code> and converting <code>HeartDisease</code> and other categorical variables to factor type with <code>as.factor()</code> within <code>mutate()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>heart_data <span class="ot">&lt;-</span> heart_data <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ST_Slope) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeartDisease =</span> <span class="fu">as.factor</span>(HeartDisease),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">as.factor</span>(Sex),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ChestPainType=</span> <span class="fu">as.factor</span>(ChestPainType),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ExerciseAngina =</span> <span class="fu">as.factor</span>(ExerciseAngina),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">RestingECG =</span> <span class="fu">as.factor</span>(RestingECG))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
    Age Sex   ChestPainType RestingBP Cholesterol FastingBS RestingECG MaxHR
  &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;
1    40 M     ATA                 140         289         0 Normal       172
2    49 F     NAP                 160         180         0 Normal       156
3    37 M     ATA                 130         283         0 ST            98
4    48 F     ASY                 138         214         0 Normal       108
5    54 M     NAP                 150         195         0 Normal       122
6    39 M     NAP                 120         339         0 Normal       170
# ℹ 3 more variables: ExerciseAngina &lt;fct&gt;, Oldpeak &lt;dbl&gt;, HeartDisease &lt;fct&gt;</code></pre>
</div>
</div>
</section>
<section id="question-3-creating-dummy-variables-for-categorical-variables" class="level4">
<h4 class="anchored" data-anchor-id="question-3-creating-dummy-variables-for-categorical-variables">Question 3: Creating Dummy Variables for categorical variables</h4>
<p>Creating dummy variables using <code>dummyVars()</code>. Then creating dummy df <code>heart_cat</code> using <code>predict()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dummies <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(<span class="at">data =</span> heart_data,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">formula =</span> <span class="sc">~</span>Sex <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ExerciseAngina <span class="sc">+</span> ChestPainType <span class="sc">+</span> RestingECG)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>heart_cat <span class="ot">&lt;-</span> <span class="fu">predict</span>(dummies, <span class="at">newdata =</span> heart_data)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>heart_cat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(heart_cat)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sex.F Sex.M ExerciseAngina.N ExerciseAngina.Y ChestPainType.ASY
1     0     1                1                0                 0
2     1     0                1                0                 0
3     0     1                1                0                 0
4     1     0                0                1                 1
5     0     1                1                0                 0
6     0     1                1                0                 0
  ChestPainType.ATA ChestPainType.NAP ChestPainType.TA RestingECG.LVH
1                 1                 0                0              0
2                 0                 1                0              0
3                 1                 0                0              0
4                 0                 0                0              0
5                 0                 1                0              0
6                 0                 1                0              0
  RestingECG.Normal RestingECG.ST
1                 1             0
2                 1             0
3                 0             1
4                 1             0
5                 1             0
6                 1             0</code></pre>
</div>
</div>
<p>Combining the dummy dataframe <code>heart_cat</code> with <code>heart_data</code> using <code>bind_cols()</code> .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>heart_combined <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  heart_data <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Ommitting original categorical variables</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Sex,ChestPainType,RestingECG,ExerciseAngina)), </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  heart_cat)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Preview</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 18
    Age RestingBP Cholesterol FastingBS MaxHR Oldpeak HeartDisease Sex.F Sex.M
  &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;
1    40       140         289         0   172     0   0                0     1
2    49       160         180         0   156     1   1                1     0
3    37       130         283         0    98     0   0                0     1
4    48       138         214         0   108     1.5 1                1     0
5    54       150         195         0   122     0   0                0     1
6    39       120         339         0   170     0   0                0     1
# ℹ 9 more variables: ExerciseAngina.N &lt;dbl&gt;, ExerciseAngina.Y &lt;dbl&gt;,
#   ChestPainType.ASY &lt;dbl&gt;, ChestPainType.ATA &lt;dbl&gt;, ChestPainType.NAP &lt;dbl&gt;,
#   ChestPainType.TA &lt;dbl&gt;, RestingECG.LVH &lt;dbl&gt;, RestingECG.Normal &lt;dbl&gt;,
#   RestingECG.ST &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="split-your-data" class="level3">
<h3 class="anchored" data-anchor-id="split-your-data">Split Your Data</h3>
<p>Creating a test-train split using <code>createDataPartition()</code> from <code>caret</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> heart_combined<span class="sc">$</span>HeartDisease, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p =</span> <span class="fl">0.8</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> heart_combined[split, ]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> heart_combined[<span class="sc">-</span>split, ]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Check size</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(train) ; <span class="fu">dim</span>(test);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 735  18</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 183  18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(heart_combined); <span class="co">#final check for NULL values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="knn" class="level3">
<h3 class="anchored" data-anchor-id="knn">kNN</h3>
<p>Setting up the KNN model for predicting heart disease, Starting by defining 10-fold cross-validation with 3 repeats in <code>trctrl.</code> Then creating a <code>Grid</code> of k-values from 1 to 40 for the search. Then, using the <code>train</code> function, fitting the KNN model with <code>method = "knn"</code> to the training data, centering and scaling it, and performing a grid search to find the optimal “k” that minimizes prediction error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining CrossVal criteria</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>trctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">3</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a tuning grid for a knn model</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using knn method</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>knn_fit <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a> <span class="at">trControl=</span>trctrl,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a> <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a> <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a> <span class="at">tuneGrid =</span> Grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model details to review the results and optimal parameters</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>knn_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

735 samples
 17 predictor
  2 classes: '0', '1' 

Pre-processing: centered (17), scaled (17) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 661, 661, 662, 663, 661, 662, ... 
Resampling results across tuning parameters:

  k   Accuracy   Kappa    
   1  0.7482196  0.4938937
   2  0.7631404  0.5250626
   3  0.8003555  0.5973225
   4  0.7962642  0.5897488
   5  0.8081186  0.6119696
   6  0.8022377  0.5999737
   7  0.8081746  0.6120849
   8  0.8090320  0.6140712
   9  0.8009054  0.5968913
  10  0.8022624  0.6000968
  11  0.7968014  0.5893807
  12  0.8018059  0.5993042
  13  0.8013493  0.5983054
  14  0.8095008  0.6153232
  15  0.8094881  0.6151546
  16  0.8117465  0.6198698
  17  0.8112962  0.6190683
  18  0.8090625  0.6147555
  19  0.8135918  0.6236509
  20  0.8067921  0.6102094
  21  0.8158873  0.6281816
  22  0.8135917  0.6235000
  23  0.8127156  0.6218861
  24  0.8090873  0.6147841
  25  0.8140546  0.6244570
  26  0.8117774  0.6198850
  27  0.8117962  0.6200960
  28  0.8126846  0.6218770
  29  0.8135855  0.6235801
  30  0.8140485  0.6248732
  31  0.8145049  0.6253173
  32  0.8141042  0.6246011
  33  0.8131661  0.6227411
  34  0.8109077  0.6179787
  35  0.8167882  0.6297481
  36  0.8194971  0.6351239
  37  0.8167759  0.6292682
  38  0.8176891  0.6311501
  39  0.8195096  0.6348157
  40  0.8199662  0.6353214

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was k = 40.</code></pre>
</div>
</div>
<p>Evaluating the model performance on test set by getting predictions from the trained and tuned <code>knn_fit</code> and the true responses <code>test$HeartDisease</code> and then calling it inside <code>confusionMatrix()</code> which yeilds the necessary stats.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Predictions</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_fit,<span class="at">newdata =</span> test)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Metrics</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 64 10
         1 18 91
                                          
               Accuracy : 0.847           
                 95% CI : (0.7865, 0.8959)
    No Information Rate : 0.5519          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6878          
                                          
 Mcnemar's Test P-Value : 0.1859          
                                          
            Sensitivity : 0.7805          
            Specificity : 0.9010          
         Pos Pred Value : 0.8649          
         Neg Pred Value : 0.8349          
             Prevalence : 0.4481          
         Detection Rate : 0.3497          
   Detection Prevalence : 0.4044          
      Balanced Accuracy : 0.8407          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="logistic-regression-models" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-models">Logistic Regression Models</h3>
<section id="model-1-all-variables-no-interaction" class="level4">
<h4 class="anchored" data-anchor-id="model-1-all-variables-no-interaction">Model 1: All Variables, No Interaction</h4>
<p>Selecting <em>ALL</em> variables to train <code>logreg_fit1</code> model with same CV parameter <code>trctrl</code> using <code>method= "glm"</code>. This sets up the first logistic regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using glm method</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>logreg_fit1 <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> <span class="at">trControl=</span>trctrl,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a> <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a> <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Model Details</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>logreg_fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

735 samples
 17 predictor
  2 classes: '0', '1' 

Pre-processing: centered (17), scaled (17) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 663, 661, 661, 661, 663, 661, ... 
Resampling results:

  Accuracy   Kappa    
  0.8158823  0.6275118</code></pre>
</div>
</div>
<p>Evaluating <code>logreg_fit1</code> model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pred_lr1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(logreg_fit1,<span class="at">newdata =</span> test)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#metrics</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_lr1,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 65 12
         1 17 89
                                          
               Accuracy : 0.8415          
                 95% CI : (0.7804, 0.8912)
    No Information Rate : 0.5519          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6778          
                                          
 Mcnemar's Test P-Value : 0.4576          
                                          
            Sensitivity : 0.7927          
            Specificity : 0.8812          
         Pos Pred Value : 0.8442          
         Neg Pred Value : 0.8396          
             Prevalence : 0.4481          
         Detection Rate : 0.3552          
   Detection Prevalence : 0.4208          
      Balanced Accuracy : 0.8369          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="model-2-numeric-predictors" class="level4">
<h4 class="anchored" data-anchor-id="model-2-numeric-predictors">Model 2: Numeric Predictors</h4>
<p>Selecting <em>Numeric</em> variables to train <code>logreg_fit2</code> model with same CV parameter <code>trctrl</code> using <code>method= "glm"</code>. This sets up the second logistic regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using glm method with all numeric</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>logreg_fit2 <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>.,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">select</span>(<span class="fu">c</span>(Age, RestingBP, Cholesterol,   FastingBS,MaxHR,Oldpeak),HeartDisease),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a> <span class="at">trControl=</span>trctrl,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a> <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a> <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Model Details</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>logreg_fit2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

735 samples
  6 predictor
  2 classes: '0', '1' 

Pre-processing: centered (6), scaled (6) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 661, 661, 662, 661, 662, 661, ... 
Resampling results:

  Accuracy   Kappa    
  0.7651689  0.5256172</code></pre>
</div>
</div>
<p>Evaluating <code>logreg_fit2</code> model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>pred_lr2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(logreg_fit2,<span class="at">newdata =</span> test)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#metrics</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_lr2,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 55 19
         1 27 82
                                          
               Accuracy : 0.7486          
                 95% CI : (0.6793, 0.8097)
    No Information Rate : 0.5519          
    P-Value [Acc &gt; NIR] : 2.92e-08        
                                          
                  Kappa : 0.4871          
                                          
 Mcnemar's Test P-Value : 0.302           
                                          
            Sensitivity : 0.6707          
            Specificity : 0.8119          
         Pos Pred Value : 0.7432          
         Neg Pred Value : 0.7523          
             Prevalence : 0.4481          
         Detection Rate : 0.3005          
   Detection Prevalence : 0.4044          
      Balanced Accuracy : 0.7413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="model-3-categorical-predictors-only" class="level4">
<h4 class="anchored" data-anchor-id="model-3-categorical-predictors-only">Model 3: Categorical Predictors Only</h4>
<p>Selecting <em>Categorical</em> variables to train <code>logreg_fit3</code> model with same CV parameter <code>trctrl</code> using <code>method= "glm"</code>. This sets up the second logistic regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using glm method with all categorical data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>logreg_fit3 <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>.,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Age, RestingBP, Cholesterol,   FastingBS,MaxHR,Oldpeak)),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a> <span class="at">trControl=</span>trctrl,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a> <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Model details</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>logreg_fit3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

735 samples
 11 predictor
  2 classes: '0', '1' 

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 661, 661, 662, 661, 662, 661, ... 
Resampling results:

  Accuracy   Kappa    
  0.7873271  0.5668672</code></pre>
</div>
</div>
<p>Evaluating <code>logreg_fit3</code> model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Predictions</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>pred_lr3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(logreg_fit3,<span class="at">newdata =</span> test)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Metrics</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_lr3,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 57 10
         1 25 91
                                         
               Accuracy : 0.8087         
                 95% CI : (0.7442, 0.863)
    No Information Rate : 0.5519         
    P-Value [Acc &gt; NIR] : 2.522e-13      
                                         
                  Kappa : 0.6065         
                                         
 Mcnemar's Test P-Value : 0.01796        
                                         
            Sensitivity : 0.6951         
            Specificity : 0.9010         
         Pos Pred Value : 0.8507         
         Neg Pred Value : 0.7845         
             Prevalence : 0.4481         
         Detection Rate : 0.3115         
   Detection Prevalence : 0.3661         
      Balanced Accuracy : 0.7981         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
</div>
</section>
<section id="best-model-summarybest-logreg-model" class="level4">
<h4 class="anchored" data-anchor-id="best-model-summarybest-logreg-model">Best Model Summary(Best LogReg Model)</h4>
<p>Based on the accuracy metrics, the best model is <code>logreg_fit1</code> with accuracy of 0.8415 on the test set. This model takes in <em>ALL</em> the independent variables from the dataset to form predictions. Yielding the model summary using <code>summary()</code> from base R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logreg_fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients: (4 not defined because of singularities)
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        0.42511    0.11208   3.793 0.000149 ***
Age                0.12332    0.12571   0.981 0.326592    
RestingBP          0.08304    0.10994   0.755 0.450037    
Cholesterol       -0.37524    0.12380  -3.031 0.002436 ** 
FastingBS          0.50218    0.11667   4.304 1.67e-05 ***
MaxHR             -0.34440    0.12307  -2.798 0.005137 ** 
Oldpeak            0.73703    0.12906   5.711 1.13e-08 ***
Sex.F             -0.48195    0.11193  -4.306 1.66e-05 ***
Sex.M                   NA         NA      NA       NA    
ExerciseAngina.N  -0.66288    0.12129  -5.465 4.62e-08 ***
ExerciseAngina.Y        NA         NA      NA       NA    
ChestPainType.ASY  0.24026    0.21837   1.100 0.271210    
ChestPainType.ATA -0.50644    0.19000  -2.666 0.007687 ** 
ChestPainType.NAP -0.45863    0.19075  -2.404 0.016204 *  
ChestPainType.TA        NA         NA      NA       NA    
RestingECG.LVH     0.17670    0.14134   1.250 0.211253    
RestingECG.Normal  0.14964    0.14218   1.053 0.292555    
RestingECG.ST           NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1010.42  on 734  degrees of freedom
Residual deviance:  572.48  on 721  degrees of freedom
AIC: 600.48

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
</section>
<section id="tree-based-models" class="level3">
<h3 class="anchored" data-anchor-id="tree-based-models">Tree Based Models</h3>
<p><em>Using ALL variables from the dataset to train Tree Based Models</em> .</p>
<section id="tree-classifier-model" class="level4">
<h4 class="anchored" data-anchor-id="tree-classifier-model">Tree Classifier Model</h4>
<p>Setting up the first tree based model for predicting heart disease, First using CV criteria as defined in <code>trctrl.</code> Then creating <code>tree_grid1</code> associated with <code>method = "rpart"</code> for parameter tuning, Using <code>train()</code> to train the model with a grid search to find the optimal parameters that minimizes prediction error</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a tuning grid for a rpart model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>tree_grid1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">cp =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="at">by =</span> <span class="fl">0.001</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using rpart method</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>tree_fit1 <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> trctrl,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> tree_grid1)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Details</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>tree_fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

735 samples
 17 predictor
  2 classes: '0', '1' 

Pre-processing: centered (17), scaled (17) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 661, 661, 661, 661, 661, 663, ... 
Resampling results across tuning parameters:

  cp     Accuracy   Kappa    
  0.000  0.7799774  0.5528918
  0.001  0.7813725  0.5555697
  0.002  0.7813848  0.5553395
  0.003  0.7818353  0.5564432
  0.004  0.7845438  0.5612398
  0.005  0.7849942  0.5623907
  0.006  0.7890608  0.5708441
  0.007  0.7908811  0.5748866
  0.008  0.7890670  0.5716017
  0.009  0.7890670  0.5716382
  0.010  0.7890670  0.5718944
  0.011  0.7854449  0.5649510
  0.012  0.7827298  0.5606004
  0.013  0.7827298  0.5606004
  0.014  0.7813661  0.5584434
  0.015  0.7804652  0.5562365
  0.016  0.7786573  0.5518720
  0.017  0.7782130  0.5507071
  0.018  0.7782130  0.5507071
  0.019  0.7777562  0.5467718
  0.020  0.7768491  0.5442370
  0.021  0.7723192  0.5336819
  0.022  0.7723192  0.5336819
  0.023  0.7732201  0.5357966
  0.024  0.7645872  0.5190400
  0.025  0.7645872  0.5190400
  0.026  0.7641306  0.5183612
  0.027  0.7641306  0.5183612
  0.028  0.7622912  0.5150178
  0.029  0.7622912  0.5150178
  0.030  0.7622912  0.5150178
  0.031  0.7595700  0.5100809
  0.032  0.7595700  0.5100809
  0.033  0.7595700  0.5100809
  0.034  0.7582187  0.5071023
  0.035  0.7582187  0.5071023
  0.036  0.7582187  0.5071023
  0.037  0.7582187  0.5071023
  0.038  0.7582187  0.5081226
  0.039  0.7582187  0.5081226
  0.040  0.7582187  0.5081226
  0.041  0.7577682  0.5071531
  0.042  0.7577682  0.5071531
  0.043  0.7577682  0.5071531
  0.044  0.7577682  0.5071531
  0.045  0.7568673  0.5054117
  0.046  0.7568673  0.5054117
  0.047  0.7568673  0.5054117
  0.048  0.7559539  0.5041242
  0.049  0.7559539  0.5041242
  0.050  0.7559539  0.5041242
  0.051  0.7559539  0.5041242
  0.052  0.7559539  0.5041242
  0.053  0.7559539  0.5041242
  0.054  0.7559539  0.5041242
  0.055  0.7568610  0.5069764
  0.056  0.7568610  0.5069764
  0.057  0.7568610  0.5069764
  0.058  0.7545462  0.5028342
  0.059  0.7545462  0.5028342
  0.060  0.7545462  0.5028342
  0.061  0.7545462  0.5028342
  0.062  0.7545462  0.5028342
  0.063  0.7545462  0.5028342
  0.064  0.7545462  0.5028342
  0.065  0.7518249  0.4978853
  0.066  0.7518249  0.4978853
  0.067  0.7518249  0.4978853
  0.068  0.7499985  0.4949607
  0.069  0.7499985  0.4949607
  0.070  0.7499985  0.4949607
  0.071  0.7490725  0.4931702
  0.072  0.7459132  0.4879566
  0.073  0.7459132  0.4879566
  0.074  0.7459132  0.4879566
  0.075  0.7450123  0.4866502
  0.076  0.7450123  0.4866502
  0.077  0.7450123  0.4866502
  0.078  0.7454628  0.4879248
  0.079  0.7454628  0.4879248
  0.080  0.7454628  0.4879248
  0.081  0.7454628  0.4879248
  0.082  0.7459194  0.4889513
  0.083  0.7459194  0.4889513
  0.084  0.7459194  0.4889513
  0.085  0.7459194  0.4889513
  0.086  0.7459194  0.4889513
  0.087  0.7459194  0.4889513
  0.088  0.7459194  0.4889513
  0.089  0.7459194  0.4889513
  0.090  0.7459194  0.4889513
  0.091  0.7459194  0.4889513
  0.092  0.7459194  0.4889513
  0.093  0.7459194  0.4889513
  0.094  0.7459194  0.4889513
  0.095  0.7459194  0.4889513
  0.096  0.7459194  0.4889513
  0.097  0.7459194  0.4889513
  0.098  0.7459194  0.4889513
  0.099  0.7459194  0.4889513
  0.100  0.7459194  0.4889513

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was cp = 0.007.</code></pre>
</div>
</div>
<p>Evaluating <code>tree_fit1</code> model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>pred_tree1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_fit1,<span class="at">newdata =</span> test)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#metrics</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_tree1,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 58 13
         1 24 88
                                          
               Accuracy : 0.7978          
                 95% CI : (0.7323, 0.8535)
    No Information Rate : 0.5519          
    P-Value [Acc &gt; NIR] : 2.794e-12       
                                          
                  Kappa : 0.586           
                                          
 Mcnemar's Test P-Value : 0.1002          
                                          
            Sensitivity : 0.7073          
            Specificity : 0.8713          
         Pos Pred Value : 0.8169          
         Neg Pred Value : 0.7857          
             Prevalence : 0.4481          
         Detection Rate : 0.3169          
   Detection Prevalence : 0.3880          
      Balanced Accuracy : 0.7893          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="random-forest-model" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-model">Random Forest Model</h4>
<p>Setting up the second tree based model using CV criteria as defined in <code>trctrl.</code> with <code>tree_grid2</code> associated with <code>method = "rf"</code> for parameter tuning, Using <code>train()</code> to train and fit the model with a grid search.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a tuning grid for a tree-based model</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>tree_grid2 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(<span class="fu">colnames</span>(train))<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using random forest method</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>tree_fit2 <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> trctrl,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> tree_grid2)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Details</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>tree_fit2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

735 samples
 17 predictor
  2 classes: '0', '1' 

Pre-processing: centered (17), scaled (17) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 661, 662, 661, 661, 663, 661, ... 
Resampling results across tuning parameters:

  mtry  Accuracy   Kappa    
   1    0.8149902  0.6242579
   2    0.8267639  0.6484794
   3    0.8244743  0.6440197
   4    0.8235732  0.6419537
   5    0.8176869  0.6301422
   6    0.8167549  0.6281923
   7    0.8181123  0.6310154
   8    0.8162858  0.6275977
   9    0.8162981  0.6271530
  10    0.8108367  0.6161056
  11    0.8094853  0.6132553
  12    0.8122004  0.6184814
  13    0.8085534  0.6112916
  14    0.8126568  0.6197330
  15    0.8094728  0.6132188
  16    0.8126755  0.6196122
  17    0.8080965  0.6104710

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was mtry = 2.</code></pre>
</div>
</div>
<p>Evaluating <code>tree_fit2</code> model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pred_tree2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_fit2,<span class="at">newdata =</span> test)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#metrics</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_tree2,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 65 10
         1 17 91
                                          
               Accuracy : 0.8525          
                 95% CI : (0.7926, 0.9005)
    No Information Rate : 0.5519          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6993          
                                          
 Mcnemar's Test P-Value : 0.2482          
                                          
            Sensitivity : 0.7927          
            Specificity : 0.9010          
         Pos Pred Value : 0.8667          
         Neg Pred Value : 0.8426          
             Prevalence : 0.4481          
         Detection Rate : 0.3552          
   Detection Prevalence : 0.4098          
      Balanced Accuracy : 0.8468          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="boosted-tree-model" class="level4">
<h4 class="anchored" data-anchor-id="boosted-tree-model">Boosted Tree Model</h4>
<p>Setting up the third tree based model using CV criteria as defined in <code>trctrl.</code> with <code>tree_grid3</code> associated with <code>method = "gbm"</code> for parameter tuning, Using <code>train()</code> to train and fit the model with a grid search.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a tuning grid for a tree-based model</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>tree_grid3 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">n.trees=</span> <span class="fu">c</span>( <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">interaction.depth =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shrinkage =</span> <span class="fl">0.1</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n.minobsinnode =</span> <span class="dv">10</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model using boosted tree method</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>tree_fit3 <span class="ot">&lt;-</span> <span class="fu">train</span>(HeartDisease <span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> trctrl,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> tree_grid3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3257             nan     0.1000    0.0229
     2        1.2854             nan     0.1000    0.0199
     3        1.2505             nan     0.1000    0.0170
     4        1.2185             nan     0.1000    0.0158
     5        1.1912             nan     0.1000    0.0137
     6        1.1649             nan     0.1000    0.0120
     7        1.1446             nan     0.1000    0.0073
     8        1.1235             nan     0.1000    0.0101
     9        1.1037             nan     0.1000    0.0085
    10        1.0878             nan     0.1000    0.0060
    20        0.9526             nan     0.1000    0.0041
    40        0.8355             nan     0.1000    0.0012
    60        0.7880             nan     0.1000   -0.0003
    80        0.7545             nan     0.1000    0.0000
   100        0.7352             nan     0.1000   -0.0009
   120        0.7213             nan     0.1000   -0.0009
   140        0.7106             nan     0.1000   -0.0007
   160        0.7033             nan     0.1000   -0.0014
   180        0.6971             nan     0.1000   -0.0013
   200        0.6912             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3116             nan     0.1000    0.0280
     2        1.2552             nan     0.1000    0.0246
     3        1.2047             nan     0.1000    0.0234
     4        1.1557             nan     0.1000    0.0203
     5        1.1139             nan     0.1000    0.0206
     6        1.0832             nan     0.1000    0.0118
     7        1.0525             nan     0.1000    0.0149
     8        1.0248             nan     0.1000    0.0134
     9        0.9995             nan     0.1000    0.0106
    10        0.9818             nan     0.1000    0.0071
    20        0.8492             nan     0.1000    0.0018
    40        0.7416             nan     0.1000   -0.0008
    60        0.7040             nan     0.1000   -0.0004
    80        0.6804             nan     0.1000   -0.0012
   100        0.6534             nan     0.1000   -0.0013
   120        0.6288             nan     0.1000   -0.0012
   140        0.6075             nan     0.1000   -0.0007
   160        0.5895             nan     0.1000   -0.0011
   180        0.5739             nan     0.1000   -0.0018
   200        0.5625             nan     0.1000   -0.0020

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2945             nan     0.1000    0.0377
     2        1.2377             nan     0.1000    0.0269
     3        1.1857             nan     0.1000    0.0240
     4        1.1450             nan     0.1000    0.0177
     5        1.1041             nan     0.1000    0.0169
     6        1.0636             nan     0.1000    0.0171
     7        1.0235             nan     0.1000    0.0173
     8        0.9940             nan     0.1000    0.0132
     9        0.9720             nan     0.1000    0.0093
    10        0.9512             nan     0.1000    0.0085
    20        0.8113             nan     0.1000    0.0025
    40        0.7033             nan     0.1000   -0.0001
    60        0.6510             nan     0.1000   -0.0018
    80        0.6123             nan     0.1000   -0.0016
   100        0.5781             nan     0.1000   -0.0014
   120        0.5484             nan     0.1000   -0.0003
   140        0.5214             nan     0.1000   -0.0014
   160        0.5009             nan     0.1000   -0.0021
   180        0.4735             nan     0.1000   -0.0011
   200        0.4540             nan     0.1000   -0.0020

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3329             nan     0.1000    0.0202
     2        1.2908             nan     0.1000    0.0193
     3        1.2589             nan     0.1000    0.0148
     4        1.2259             nan     0.1000    0.0148
     5        1.1987             nan     0.1000    0.0119
     6        1.1710             nan     0.1000    0.0124
     7        1.1517             nan     0.1000    0.0088
     8        1.1311             nan     0.1000    0.0078
     9        1.1135             nan     0.1000    0.0072
    10        1.0957             nan     0.1000    0.0076
    20        0.9724             nan     0.1000    0.0029
    40        0.8525             nan     0.1000    0.0012
    60        0.8030             nan     0.1000   -0.0003
    80        0.7728             nan     0.1000    0.0001
   100        0.7539             nan     0.1000   -0.0005
   120        0.7406             nan     0.1000   -0.0001
   140        0.7283             nan     0.1000   -0.0005
   160        0.7212             nan     0.1000   -0.0002
   180        0.7145             nan     0.1000   -0.0008
   200        0.7087             nan     0.1000   -0.0004

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3208             nan     0.1000    0.0269
     2        1.2576             nan     0.1000    0.0304
     3        1.2051             nan     0.1000    0.0246
     4        1.1705             nan     0.1000    0.0163
     5        1.1255             nan     0.1000    0.0186
     6        1.0899             nan     0.1000    0.0156
     7        1.0639             nan     0.1000    0.0128
     8        1.0412             nan     0.1000    0.0105
     9        1.0152             nan     0.1000    0.0111
    10        0.9996             nan     0.1000    0.0061
    20        0.8577             nan     0.1000    0.0034
    40        0.7570             nan     0.1000   -0.0011
    60        0.7124             nan     0.1000    0.0008
    80        0.6845             nan     0.1000   -0.0004
   100        0.6629             nan     0.1000   -0.0011
   120        0.6412             nan     0.1000   -0.0010
   140        0.6200             nan     0.1000   -0.0014
   160        0.6022             nan     0.1000   -0.0015
   180        0.5879             nan     0.1000   -0.0017
   200        0.5700             nan     0.1000   -0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3074             nan     0.1000    0.0307
     2        1.2458             nan     0.1000    0.0292
     3        1.1966             nan     0.1000    0.0208
     4        1.1557             nan     0.1000    0.0187
     5        1.1081             nan     0.1000    0.0212
     6        1.0780             nan     0.1000    0.0117
     7        1.0357             nan     0.1000    0.0178
     8        1.0062             nan     0.1000    0.0123
     9        0.9821             nan     0.1000    0.0110
    10        0.9638             nan     0.1000    0.0076
    20        0.8204             nan     0.1000    0.0044
    40        0.7136             nan     0.1000   -0.0016
    60        0.6591             nan     0.1000   -0.0001
    80        0.6210             nan     0.1000   -0.0004
   100        0.5897             nan     0.1000   -0.0023
   120        0.5534             nan     0.1000   -0.0008
   140        0.5258             nan     0.1000   -0.0013
   160        0.5001             nan     0.1000   -0.0021
   180        0.4804             nan     0.1000   -0.0021
   200        0.4596             nan     0.1000   -0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3308             nan     0.1000    0.0195
     2        1.2879             nan     0.1000    0.0214
     3        1.2485             nan     0.1000    0.0201
     4        1.2169             nan     0.1000    0.0157
     5        1.1840             nan     0.1000    0.0144
     6        1.1563             nan     0.1000    0.0112
     7        1.1367             nan     0.1000    0.0074
     8        1.1157             nan     0.1000    0.0077
     9        1.0943             nan     0.1000    0.0103
    10        1.0747             nan     0.1000    0.0098
    20        0.9435             nan     0.1000    0.0035
    40        0.8190             nan     0.1000    0.0017
    60        0.7632             nan     0.1000   -0.0007
    80        0.7325             nan     0.1000   -0.0002
   100        0.7122             nan     0.1000   -0.0006
   120        0.7002             nan     0.1000   -0.0004
   140        0.6879             nan     0.1000   -0.0013
   160        0.6819             nan     0.1000   -0.0005
   180        0.6733             nan     0.1000   -0.0002
   200        0.6652             nan     0.1000   -0.0002

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3115             nan     0.1000    0.0290
     2        1.2571             nan     0.1000    0.0233
     3        1.2002             nan     0.1000    0.0279
     4        1.1485             nan     0.1000    0.0220
     5        1.1128             nan     0.1000    0.0160
     6        1.0762             nan     0.1000    0.0160
     7        1.0429             nan     0.1000    0.0117
     8        1.0191             nan     0.1000    0.0097
     9        0.9917             nan     0.1000    0.0118
    10        0.9684             nan     0.1000    0.0108
    20        0.8233             nan     0.1000    0.0029
    40        0.7195             nan     0.1000    0.0002
    60        0.6790             nan     0.1000   -0.0012
    80        0.6488             nan     0.1000   -0.0002
   100        0.6276             nan     0.1000   -0.0021
   120        0.6061             nan     0.1000   -0.0005
   140        0.5879             nan     0.1000   -0.0005
   160        0.5705             nan     0.1000   -0.0009
   180        0.5574             nan     0.1000   -0.0016
   200        0.5449             nan     0.1000   -0.0017

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2927             nan     0.1000    0.0372
     2        1.2270             nan     0.1000    0.0315
     3        1.1760             nan     0.1000    0.0254
     4        1.1259             nan     0.1000    0.0225
     5        1.0839             nan     0.1000    0.0185
     6        1.0458             nan     0.1000    0.0161
     7        1.0113             nan     0.1000    0.0134
     8        0.9837             nan     0.1000    0.0104
     9        0.9592             nan     0.1000    0.0085
    10        0.9372             nan     0.1000    0.0090
    20        0.7885             nan     0.1000    0.0015
    40        0.6742             nan     0.1000    0.0003
    60        0.6181             nan     0.1000   -0.0017
    80        0.5834             nan     0.1000   -0.0005
   100        0.5484             nan     0.1000   -0.0013
   120        0.5226             nan     0.1000   -0.0015
   140        0.4984             nan     0.1000   -0.0001
   160        0.4786             nan     0.1000   -0.0017
   180        0.4573             nan     0.1000   -0.0011
   200        0.4375             nan     0.1000   -0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3350             nan     0.1000    0.0185
     2        1.2914             nan     0.1000    0.0209
     3        1.2672             nan     0.1000    0.0115
     4        1.2349             nan     0.1000    0.0174
     5        1.2061             nan     0.1000    0.0147
     6        1.1820             nan     0.1000    0.0100
     7        1.1609             nan     0.1000    0.0089
     8        1.1419             nan     0.1000    0.0074
     9        1.1214             nan     0.1000    0.0094
    10        1.1004             nan     0.1000    0.0101
    20        0.9674             nan     0.1000    0.0037
    40        0.8415             nan     0.1000    0.0012
    60        0.7854             nan     0.1000    0.0000
    80        0.7561             nan     0.1000   -0.0002
   100        0.7356             nan     0.1000   -0.0000
   120        0.7217             nan     0.1000   -0.0010
   140        0.7106             nan     0.1000   -0.0007
   160        0.7037             nan     0.1000   -0.0008
   180        0.6962             nan     0.1000   -0.0010
   200        0.6886             nan     0.1000   -0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3094             nan     0.1000    0.0313
     2        1.2576             nan     0.1000    0.0247
     3        1.2035             nan     0.1000    0.0268
     4        1.1559             nan     0.1000    0.0217
     5        1.1222             nan     0.1000    0.0157
     6        1.0858             nan     0.1000    0.0170
     7        1.0578             nan     0.1000    0.0144
     8        1.0325             nan     0.1000    0.0108
     9        1.0137             nan     0.1000    0.0085
    10        0.9936             nan     0.1000    0.0080
    20        0.8509             nan     0.1000    0.0033
    40        0.7471             nan     0.1000    0.0001
    60        0.6989             nan     0.1000   -0.0010
    80        0.6693             nan     0.1000   -0.0006
   100        0.6394             nan     0.1000   -0.0004
   120        0.6155             nan     0.1000   -0.0009
   140        0.5980             nan     0.1000   -0.0011
   160        0.5826             nan     0.1000   -0.0018
   180        0.5686             nan     0.1000   -0.0006
   200        0.5488             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3078             nan     0.1000    0.0286
     2        1.2476             nan     0.1000    0.0267
     3        1.1854             nan     0.1000    0.0284
     4        1.1353             nan     0.1000    0.0228
     5        1.0902             nan     0.1000    0.0202
     6        1.0559             nan     0.1000    0.0157
     7        1.0260             nan     0.1000    0.0131
     8        0.9964             nan     0.1000    0.0121
     9        0.9667             nan     0.1000    0.0120
    10        0.9461             nan     0.1000    0.0102
    20        0.8104             nan     0.1000    0.0015
    40        0.6963             nan     0.1000   -0.0013
    60        0.6467             nan     0.1000   -0.0006
    80        0.6012             nan     0.1000   -0.0018
   100        0.5728             nan     0.1000   -0.0016
   120        0.5388             nan     0.1000   -0.0013
   140        0.5161             nan     0.1000   -0.0016
   160        0.4898             nan     0.1000   -0.0011
   180        0.4646             nan     0.1000   -0.0013
   200        0.4475             nan     0.1000   -0.0016

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3272             nan     0.1000    0.0252
     2        1.2850             nan     0.1000    0.0205
     3        1.2471             nan     0.1000    0.0183
     4        1.2131             nan     0.1000    0.0151
     5        1.1835             nan     0.1000    0.0140
     6        1.1577             nan     0.1000    0.0111
     7        1.1318             nan     0.1000    0.0116
     8        1.1131             nan     0.1000    0.0097
     9        1.0945             nan     0.1000    0.0073
    10        1.0783             nan     0.1000    0.0077
    20        0.9516             nan     0.1000    0.0039
    40        0.8362             nan     0.1000   -0.0004
    60        0.7864             nan     0.1000   -0.0010
    80        0.7558             nan     0.1000   -0.0009
   100        0.7339             nan     0.1000   -0.0009
   120        0.7207             nan     0.1000   -0.0005
   140        0.7129             nan     0.1000   -0.0008
   160        0.7055             nan     0.1000   -0.0008
   180        0.6989             nan     0.1000   -0.0007
   200        0.6921             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3080             nan     0.1000    0.0294
     2        1.2536             nan     0.1000    0.0214
     3        1.2073             nan     0.1000    0.0184
     4        1.1600             nan     0.1000    0.0237
     5        1.1186             nan     0.1000    0.0187
     6        1.0889             nan     0.1000    0.0134
     7        1.0624             nan     0.1000    0.0118
     8        1.0357             nan     0.1000    0.0115
     9        1.0081             nan     0.1000    0.0125
    10        0.9844             nan     0.1000    0.0100
    20        0.8435             nan     0.1000    0.0030
    40        0.7436             nan     0.1000   -0.0015
    60        0.7025             nan     0.1000   -0.0020
    80        0.6738             nan     0.1000   -0.0009
   100        0.6503             nan     0.1000   -0.0014
   120        0.6265             nan     0.1000   -0.0012
   140        0.6033             nan     0.1000   -0.0001
   160        0.5888             nan     0.1000   -0.0011
   180        0.5727             nan     0.1000   -0.0009
   200        0.5583             nan     0.1000   -0.0003

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3053             nan     0.1000    0.0305
     2        1.2446             nan     0.1000    0.0276
     3        1.1850             nan     0.1000    0.0282
     4        1.1393             nan     0.1000    0.0200
     5        1.1006             nan     0.1000    0.0169
     6        1.0593             nan     0.1000    0.0186
     7        1.0310             nan     0.1000    0.0114
     8        1.0000             nan     0.1000    0.0139
     9        0.9730             nan     0.1000    0.0120
    10        0.9567             nan     0.1000    0.0060
    20        0.8080             nan     0.1000    0.0037
    40        0.6962             nan     0.1000   -0.0011
    60        0.6426             nan     0.1000   -0.0013
    80        0.5991             nan     0.1000   -0.0012
   100        0.5665             nan     0.1000   -0.0018
   120        0.5378             nan     0.1000   -0.0008
   140        0.5101             nan     0.1000   -0.0004
   160        0.4895             nan     0.1000   -0.0016
   180        0.4681             nan     0.1000   -0.0015
   200        0.4506             nan     0.1000   -0.0019

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3291             nan     0.1000    0.0194
     2        1.2888             nan     0.1000    0.0204
     3        1.2463             nan     0.1000    0.0208
     4        1.2167             nan     0.1000    0.0153
     5        1.1845             nan     0.1000    0.0157
     6        1.1572             nan     0.1000    0.0126
     7        1.1329             nan     0.1000    0.0112
     8        1.1118             nan     0.1000    0.0099
     9        1.0939             nan     0.1000    0.0088
    10        1.0776             nan     0.1000    0.0058
    20        0.9446             nan     0.1000    0.0032
    40        0.8162             nan     0.1000    0.0012
    60        0.7638             nan     0.1000    0.0006
    80        0.7341             nan     0.1000   -0.0005
   100        0.7137             nan     0.1000   -0.0002
   120        0.6987             nan     0.1000   -0.0013
   140        0.6850             nan     0.1000   -0.0010
   160        0.6762             nan     0.1000   -0.0007
   180        0.6689             nan     0.1000   -0.0003
   200        0.6644             nan     0.1000   -0.0001

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3160             nan     0.1000    0.0283
     2        1.2452             nan     0.1000    0.0289
     3        1.1955             nan     0.1000    0.0223
     4        1.1543             nan     0.1000    0.0202
     5        1.1081             nan     0.1000    0.0213
     6        1.0816             nan     0.1000    0.0130
     7        1.0435             nan     0.1000    0.0152
     8        1.0204             nan     0.1000    0.0098
     9        0.9988             nan     0.1000    0.0096
    10        0.9759             nan     0.1000    0.0098
    20        0.8374             nan     0.1000    0.0034
    40        0.7342             nan     0.1000    0.0009
    60        0.6820             nan     0.1000   -0.0007
    80        0.6507             nan     0.1000   -0.0000
   100        0.6257             nan     0.1000   -0.0016
   120        0.6019             nan     0.1000   -0.0004
   140        0.5843             nan     0.1000   -0.0021
   160        0.5650             nan     0.1000   -0.0007
   180        0.5501             nan     0.1000   -0.0008
   200        0.5371             nan     0.1000   -0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2996             nan     0.1000    0.0371
     2        1.2361             nan     0.1000    0.0296
     3        1.1860             nan     0.1000    0.0227
     4        1.1334             nan     0.1000    0.0234
     5        1.0935             nan     0.1000    0.0184
     6        1.0574             nan     0.1000    0.0158
     7        1.0194             nan     0.1000    0.0157
     8        0.9933             nan     0.1000    0.0109
     9        0.9663             nan     0.1000    0.0111
    10        0.9395             nan     0.1000    0.0103
    20        0.8037             nan     0.1000    0.0028
    40        0.6949             nan     0.1000   -0.0007
    60        0.6361             nan     0.1000   -0.0013
    80        0.5883             nan     0.1000   -0.0009
   100        0.5525             nan     0.1000   -0.0019
   120        0.5206             nan     0.1000   -0.0019
   140        0.4984             nan     0.1000   -0.0005
   160        0.4762             nan     0.1000   -0.0023
   180        0.4549             nan     0.1000   -0.0012
   200        0.4305             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3241             nan     0.1000    0.0228
     2        1.2858             nan     0.1000    0.0204
     3        1.2524             nan     0.1000    0.0170
     4        1.2212             nan     0.1000    0.0142
     5        1.1945             nan     0.1000    0.0134
     6        1.1692             nan     0.1000    0.0105
     7        1.1414             nan     0.1000    0.0124
     8        1.1181             nan     0.1000    0.0102
     9        1.1005             nan     0.1000    0.0096
    10        1.0862             nan     0.1000    0.0049
    20        0.9596             nan     0.1000    0.0019
    40        0.8381             nan     0.1000    0.0011
    60        0.7902             nan     0.1000    0.0006
    80        0.7661             nan     0.1000   -0.0012
   100        0.7507             nan     0.1000   -0.0009
   120        0.7367             nan     0.1000   -0.0007
   140        0.7264             nan     0.1000   -0.0002
   160        0.7207             nan     0.1000   -0.0014
   180        0.7135             nan     0.1000   -0.0006
   200        0.7079             nan     0.1000   -0.0004

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3155             nan     0.1000    0.0277
     2        1.2629             nan     0.1000    0.0241
     3        1.2245             nan     0.1000    0.0154
     4        1.1740             nan     0.1000    0.0238
     5        1.1386             nan     0.1000    0.0144
     6        1.1037             nan     0.1000    0.0152
     7        1.0729             nan     0.1000    0.0150
     8        1.0390             nan     0.1000    0.0151
     9        1.0170             nan     0.1000    0.0093
    10        0.9965             nan     0.1000    0.0100
    20        0.8613             nan     0.1000    0.0026
    40        0.7639             nan     0.1000   -0.0017
    60        0.7145             nan     0.1000   -0.0016
    80        0.6822             nan     0.1000   -0.0007
   100        0.6570             nan     0.1000   -0.0010
   120        0.6379             nan     0.1000   -0.0014
   140        0.6206             nan     0.1000   -0.0016
   160        0.6042             nan     0.1000    0.0000
   180        0.5872             nan     0.1000   -0.0009
   200        0.5714             nan     0.1000   -0.0016

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3079             nan     0.1000    0.0313
     2        1.2416             nan     0.1000    0.0325
     3        1.1857             nan     0.1000    0.0251
     4        1.1442             nan     0.1000    0.0192
     5        1.1065             nan     0.1000    0.0176
     6        1.0768             nan     0.1000    0.0129
     7        1.0391             nan     0.1000    0.0163
     8        1.0068             nan     0.1000    0.0117
     9        0.9819             nan     0.1000    0.0111
    10        0.9574             nan     0.1000    0.0113
    20        0.8232             nan     0.1000    0.0034
    40        0.7216             nan     0.1000   -0.0001
    60        0.6714             nan     0.1000   -0.0012
    80        0.6332             nan     0.1000   -0.0011
   100        0.5960             nan     0.1000   -0.0030
   120        0.5664             nan     0.1000   -0.0019
   140        0.5450             nan     0.1000   -0.0010
   160        0.5163             nan     0.1000   -0.0007
   180        0.4968             nan     0.1000   -0.0020
   200        0.4719             nan     0.1000   -0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3261             nan     0.1000    0.0229
     2        1.2849             nan     0.1000    0.0206
     3        1.2464             nan     0.1000    0.0161
     4        1.2144             nan     0.1000    0.0155
     5        1.1819             nan     0.1000    0.0141
     6        1.1580             nan     0.1000    0.0102
     7        1.1364             nan     0.1000    0.0098
     8        1.1197             nan     0.1000    0.0064
     9        1.0984             nan     0.1000    0.0102
    10        1.0823             nan     0.1000    0.0084
    20        0.9513             nan     0.1000    0.0048
    40        0.8210             nan     0.1000    0.0007
    60        0.7670             nan     0.1000    0.0007
    80        0.7355             nan     0.1000    0.0000
   100        0.7175             nan     0.1000   -0.0011
   120        0.7018             nan     0.1000   -0.0008
   140        0.6909             nan     0.1000   -0.0003
   160        0.6822             nan     0.1000   -0.0018
   180        0.6762             nan     0.1000   -0.0021
   200        0.6689             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3100             nan     0.1000    0.0300
     2        1.2476             nan     0.1000    0.0296
     3        1.1931             nan     0.1000    0.0255
     4        1.1543             nan     0.1000    0.0173
     5        1.1139             nan     0.1000    0.0187
     6        1.0803             nan     0.1000    0.0134
     7        1.0473             nan     0.1000    0.0150
     8        1.0260             nan     0.1000    0.0107
     9        1.0018             nan     0.1000    0.0112
    10        0.9822             nan     0.1000    0.0078
    20        0.8458             nan     0.1000    0.0027
    40        0.7303             nan     0.1000   -0.0000
    60        0.6841             nan     0.1000   -0.0010
    80        0.6519             nan     0.1000   -0.0007
   100        0.6257             nan     0.1000   -0.0005
   120        0.6025             nan     0.1000   -0.0020
   140        0.5851             nan     0.1000   -0.0008
   160        0.5638             nan     0.1000   -0.0002
   180        0.5514             nan     0.1000   -0.0016
   200        0.5328             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3106             nan     0.1000    0.0294
     2        1.2491             nan     0.1000    0.0281
     3        1.1884             nan     0.1000    0.0301
     4        1.1316             nan     0.1000    0.0234
     5        1.0885             nan     0.1000    0.0203
     6        1.0548             nan     0.1000    0.0139
     7        1.0217             nan     0.1000    0.0148
     8        0.9941             nan     0.1000    0.0106
     9        0.9658             nan     0.1000    0.0113
    10        0.9451             nan     0.1000    0.0091
    20        0.8023             nan     0.1000    0.0024
    40        0.6917             nan     0.1000    0.0002
    60        0.6323             nan     0.1000   -0.0012
    80        0.5880             nan     0.1000   -0.0025
   100        0.5518             nan     0.1000   -0.0011
   120        0.5252             nan     0.1000   -0.0018
   140        0.4983             nan     0.1000   -0.0029
   160        0.4733             nan     0.1000   -0.0016
   180        0.4499             nan     0.1000   -0.0006
   200        0.4333             nan     0.1000   -0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3228             nan     0.1000    0.0245
     2        1.2771             nan     0.1000    0.0211
     3        1.2396             nan     0.1000    0.0177
     4        1.2058             nan     0.1000    0.0172
     5        1.1787             nan     0.1000    0.0136
     6        1.1596             nan     0.1000    0.0072
     7        1.1349             nan     0.1000    0.0112
     8        1.1112             nan     0.1000    0.0111
     9        1.0906             nan     0.1000    0.0094
    10        1.0702             nan     0.1000    0.0082
    20        0.9518             nan     0.1000    0.0043
    40        0.8334             nan     0.1000    0.0005
    60        0.7776             nan     0.1000   -0.0001
    80        0.7490             nan     0.1000   -0.0001
   100        0.7321             nan     0.1000   -0.0007
   120        0.7191             nan     0.1000   -0.0010
   140        0.7080             nan     0.1000   -0.0005
   160        0.6998             nan     0.1000   -0.0010
   180        0.6922             nan     0.1000   -0.0005
   200        0.6870             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3080             nan     0.1000    0.0334
     2        1.2550             nan     0.1000    0.0276
     3        1.2038             nan     0.1000    0.0214
     4        1.1647             nan     0.1000    0.0187
     5        1.1248             nan     0.1000    0.0198
     6        1.0939             nan     0.1000    0.0132
     7        1.0576             nan     0.1000    0.0164
     8        1.0242             nan     0.1000    0.0115
     9        1.0048             nan     0.1000    0.0089
    10        0.9801             nan     0.1000    0.0101
    20        0.8484             nan     0.1000    0.0043
    40        0.7454             nan     0.1000   -0.0005
    60        0.7007             nan     0.1000   -0.0004
    80        0.6705             nan     0.1000   -0.0016
   100        0.6388             nan     0.1000   -0.0013
   120        0.6164             nan     0.1000    0.0002
   140        0.6001             nan     0.1000   -0.0004
   160        0.5850             nan     0.1000   -0.0002
   180        0.5646             nan     0.1000   -0.0008
   200        0.5513             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3026             nan     0.1000    0.0331
     2        1.2476             nan     0.1000    0.0250
     3        1.1833             nan     0.1000    0.0293
     4        1.1412             nan     0.1000    0.0193
     5        1.1041             nan     0.1000    0.0160
     6        1.0589             nan     0.1000    0.0195
     7        1.0234             nan     0.1000    0.0152
     8        0.9897             nan     0.1000    0.0142
     9        0.9715             nan     0.1000    0.0046
    10        0.9482             nan     0.1000    0.0090
    20        0.8118             nan     0.1000    0.0006
    40        0.6956             nan     0.1000   -0.0004
    60        0.6398             nan     0.1000   -0.0017
    80        0.5978             nan     0.1000   -0.0018
   100        0.5627             nan     0.1000   -0.0013
   120        0.5333             nan     0.1000   -0.0022
   140        0.5083             nan     0.1000   -0.0010
   160        0.4837             nan     0.1000   -0.0014
   180        0.4653             nan     0.1000   -0.0010
   200        0.4457             nan     0.1000   -0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3352             nan     0.1000    0.0203
     2        1.2916             nan     0.1000    0.0212
     3        1.2520             nan     0.1000    0.0186
     4        1.2185             nan     0.1000    0.0159
     5        1.1908             nan     0.1000    0.0128
     6        1.1620             nan     0.1000    0.0122
     7        1.1421             nan     0.1000    0.0079
     8        1.1271             nan     0.1000    0.0055
     9        1.1065             nan     0.1000    0.0063
    10        1.0858             nan     0.1000    0.0090
    20        0.9542             nan     0.1000    0.0022
    40        0.8345             nan     0.1000    0.0019
    60        0.7838             nan     0.1000    0.0007
    80        0.7540             nan     0.1000    0.0002
   100        0.7360             nan     0.1000   -0.0007
   120        0.7249             nan     0.1000   -0.0009
   140        0.7124             nan     0.1000   -0.0014
   160        0.7040             nan     0.1000   -0.0011
   180        0.6971             nan     0.1000   -0.0005
   200        0.6896             nan     0.1000   -0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3011             nan     0.1000    0.0338
     2        1.2549             nan     0.1000    0.0229
     3        1.1980             nan     0.1000    0.0254
     4        1.1530             nan     0.1000    0.0220
     5        1.1123             nan     0.1000    0.0161
     6        1.0798             nan     0.1000    0.0147
     7        1.0504             nan     0.1000    0.0150
     8        1.0205             nan     0.1000    0.0126
     9        0.9960             nan     0.1000    0.0098
    10        0.9780             nan     0.1000    0.0075
    20        0.8429             nan     0.1000    0.0034
    40        0.7445             nan     0.1000    0.0001
    60        0.6938             nan     0.1000   -0.0012
    80        0.6621             nan     0.1000   -0.0014
   100        0.6359             nan     0.1000   -0.0007
   120        0.6136             nan     0.1000   -0.0011
   140        0.5956             nan     0.1000   -0.0008
   160        0.5799             nan     0.1000   -0.0006
   180        0.5612             nan     0.1000   -0.0013
   200        0.5474             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2972             nan     0.1000    0.0362
     2        1.2259             nan     0.1000    0.0323
     3        1.1739             nan     0.1000    0.0235
     4        1.1296             nan     0.1000    0.0178
     5        1.0876             nan     0.1000    0.0200
     6        1.0451             nan     0.1000    0.0164
     7        1.0157             nan     0.1000    0.0117
     8        0.9927             nan     0.1000    0.0096
     9        0.9661             nan     0.1000    0.0119
    10        0.9477             nan     0.1000    0.0082
    20        0.8055             nan     0.1000    0.0032
    40        0.7021             nan     0.1000   -0.0010
    60        0.6459             nan     0.1000   -0.0024
    80        0.6030             nan     0.1000   -0.0012
   100        0.5675             nan     0.1000   -0.0011
   120        0.5452             nan     0.1000   -0.0011
   140        0.5216             nan     0.1000   -0.0021
   160        0.4969             nan     0.1000   -0.0020
   180        0.4758             nan     0.1000   -0.0027
   200        0.4538             nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3282             nan     0.1000    0.0188
     2        1.2849             nan     0.1000    0.0203
     3        1.2503             nan     0.1000    0.0161
     4        1.2170             nan     0.1000    0.0170
     5        1.1871             nan     0.1000    0.0137
     6        1.1629             nan     0.1000    0.0111
     7        1.1402             nan     0.1000    0.0103
     8        1.1208             nan     0.1000    0.0089
     9        1.1066             nan     0.1000    0.0040
    10        1.0885             nan     0.1000    0.0073
    20        0.9566             nan     0.1000    0.0041
    40        0.8330             nan     0.1000    0.0004
    60        0.7738             nan     0.1000    0.0001
    80        0.7442             nan     0.1000   -0.0011
   100        0.7255             nan     0.1000    0.0002
   120        0.7109             nan     0.1000   -0.0008
   140        0.6967             nan     0.1000   -0.0001
   160        0.6916             nan     0.1000   -0.0013
   180        0.6828             nan     0.1000   -0.0011
   200        0.6776             nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3113             nan     0.1000    0.0267
     2        1.2454             nan     0.1000    0.0285
     3        1.2007             nan     0.1000    0.0193
     4        1.1587             nan     0.1000    0.0149
     5        1.1174             nan     0.1000    0.0201
     6        1.0804             nan     0.1000    0.0163
     7        1.0494             nan     0.1000    0.0124
     8        1.0219             nan     0.1000    0.0114
     9        0.9978             nan     0.1000    0.0100
    10        0.9767             nan     0.1000    0.0103
    20        0.8433             nan     0.1000    0.0036
    40        0.7320             nan     0.1000   -0.0002
    60        0.6843             nan     0.1000   -0.0002
    80        0.6560             nan     0.1000   -0.0010
   100        0.6311             nan     0.1000   -0.0009
   120        0.6066             nan     0.1000    0.0003
   140        0.5904             nan     0.1000   -0.0010
   160        0.5736             nan     0.1000   -0.0012
   180        0.5617             nan     0.1000   -0.0017
   200        0.5466             nan     0.1000   -0.0003

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3004             nan     0.1000    0.0357
     2        1.2399             nan     0.1000    0.0279
     3        1.1918             nan     0.1000    0.0222
     4        1.1440             nan     0.1000    0.0224
     5        1.1009             nan     0.1000    0.0211
     6        1.0618             nan     0.1000    0.0164
     7        1.0367             nan     0.1000    0.0112
     8        1.0085             nan     0.1000    0.0117
     9        0.9830             nan     0.1000    0.0105
    10        0.9566             nan     0.1000    0.0106
    20        0.8115             nan     0.1000    0.0018
    40        0.6931             nan     0.1000   -0.0010
    60        0.6415             nan     0.1000   -0.0018
    80        0.6011             nan     0.1000   -0.0004
   100        0.5719             nan     0.1000   -0.0005
   120        0.5453             nan     0.1000   -0.0032
   140        0.5180             nan     0.1000   -0.0013
   160        0.4981             nan     0.1000   -0.0009
   180        0.4761             nan     0.1000   -0.0012
   200        0.4560             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3298             nan     0.1000    0.0222
     2        1.2876             nan     0.1000    0.0203
     3        1.2507             nan     0.1000    0.0148
     4        1.2169             nan     0.1000    0.0142
     5        1.1882             nan     0.1000    0.0111
     6        1.1605             nan     0.1000    0.0130
     7        1.1429             nan     0.1000    0.0075
     8        1.1230             nan     0.1000    0.0088
     9        1.1048             nan     0.1000    0.0099
    10        1.0856             nan     0.1000    0.0081
    20        0.9610             nan     0.1000    0.0038
    40        0.8400             nan     0.1000    0.0009
    60        0.7877             nan     0.1000    0.0002
    80        0.7584             nan     0.1000   -0.0006
   100        0.7378             nan     0.1000   -0.0005
   120        0.7233             nan     0.1000   -0.0015
   140        0.7153             nan     0.1000   -0.0006
   160        0.7083             nan     0.1000   -0.0009
   180        0.7020             nan     0.1000   -0.0005
   200        0.6941             nan     0.1000   -0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3078             nan     0.1000    0.0328
     2        1.2492             nan     0.1000    0.0234
     3        1.1972             nan     0.1000    0.0242
     4        1.1642             nan     0.1000    0.0146
     5        1.1226             nan     0.1000    0.0184
     6        1.0924             nan     0.1000    0.0148
     7        1.0577             nan     0.1000    0.0157
     8        1.0323             nan     0.1000    0.0120
     9        1.0089             nan     0.1000    0.0100
    10        0.9824             nan     0.1000    0.0086
    20        0.8545             nan     0.1000    0.0015
    40        0.7512             nan     0.1000   -0.0001
    60        0.7037             nan     0.1000   -0.0006
    80        0.6724             nan     0.1000   -0.0014
   100        0.6453             nan     0.1000   -0.0018
   120        0.6269             nan     0.1000   -0.0019
   140        0.6107             nan     0.1000   -0.0012
   160        0.5949             nan     0.1000   -0.0014
   180        0.5764             nan     0.1000   -0.0014
   200        0.5623             nan     0.1000   -0.0017

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3140             nan     0.1000    0.0266
     2        1.2455             nan     0.1000    0.0305
     3        1.1856             nan     0.1000    0.0272
     4        1.1379             nan     0.1000    0.0204
     5        1.0959             nan     0.1000    0.0200
     6        1.0602             nan     0.1000    0.0156
     7        1.0326             nan     0.1000    0.0128
     8        1.0019             nan     0.1000    0.0130
     9        0.9751             nan     0.1000    0.0114
    10        0.9525             nan     0.1000    0.0076
    20        0.8163             nan     0.1000    0.0031
    40        0.7011             nan     0.1000   -0.0000
    60        0.6486             nan     0.1000   -0.0024
    80        0.6033             nan     0.1000   -0.0033
   100        0.5740             nan     0.1000   -0.0014
   120        0.5463             nan     0.1000   -0.0002
   140        0.5200             nan     0.1000   -0.0009
   160        0.4979             nan     0.1000   -0.0008
   180        0.4743             nan     0.1000   -0.0009
   200        0.4507             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3266             nan     0.1000    0.0213
     2        1.2819             nan     0.1000    0.0202
     3        1.2498             nan     0.1000    0.0158
     4        1.2192             nan     0.1000    0.0158
     5        1.1908             nan     0.1000    0.0144
     6        1.1628             nan     0.1000    0.0116
     7        1.1419             nan     0.1000    0.0095
     8        1.1202             nan     0.1000    0.0073
     9        1.0989             nan     0.1000    0.0103
    10        1.0806             nan     0.1000    0.0079
    20        0.9537             nan     0.1000    0.0024
    40        0.8310             nan     0.1000    0.0012
    60        0.7803             nan     0.1000    0.0006
    80        0.7486             nan     0.1000    0.0001
   100        0.7303             nan     0.1000   -0.0008
   120        0.7169             nan     0.1000   -0.0006
   140        0.7076             nan     0.1000   -0.0001
   160        0.7001             nan     0.1000   -0.0007
   180        0.6906             nan     0.1000   -0.0008
   200        0.6849             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3165             nan     0.1000    0.0296
     2        1.2527             nan     0.1000    0.0300
     3        1.2073             nan     0.1000    0.0221
     4        1.1639             nan     0.1000    0.0211
     5        1.1216             nan     0.1000    0.0219
     6        1.0893             nan     0.1000    0.0135
     7        1.0575             nan     0.1000    0.0143
     8        1.0298             nan     0.1000    0.0139
     9        1.0052             nan     0.1000    0.0108
    10        0.9875             nan     0.1000    0.0077
    20        0.8500             nan     0.1000    0.0026
    40        0.7370             nan     0.1000   -0.0006
    60        0.6962             nan     0.1000   -0.0013
    80        0.6668             nan     0.1000   -0.0012
   100        0.6418             nan     0.1000   -0.0010
   120        0.6272             nan     0.1000   -0.0018
   140        0.6043             nan     0.1000   -0.0016
   160        0.5881             nan     0.1000   -0.0010
   180        0.5699             nan     0.1000   -0.0013
   200        0.5583             nan     0.1000   -0.0020

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3062             nan     0.1000    0.0310
     2        1.2478             nan     0.1000    0.0253
     3        1.1945             nan     0.1000    0.0268
     4        1.1379             nan     0.1000    0.0246
     5        1.0997             nan     0.1000    0.0171
     6        1.0669             nan     0.1000    0.0146
     7        1.0309             nan     0.1000    0.0151
     8        0.9977             nan     0.1000    0.0150
     9        0.9723             nan     0.1000    0.0099
    10        0.9509             nan     0.1000    0.0057
    20        0.8082             nan     0.1000   -0.0007
    40        0.6973             nan     0.1000    0.0018
    60        0.6464             nan     0.1000   -0.0015
    80        0.6006             nan     0.1000   -0.0010
   100        0.5701             nan     0.1000   -0.0024
   120        0.5379             nan     0.1000   -0.0018
   140        0.5101             nan     0.1000   -0.0009
   160        0.4885             nan     0.1000   -0.0016
   180        0.4660             nan     0.1000   -0.0009
   200        0.4479             nan     0.1000   -0.0021

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3257             nan     0.1000    0.0231
     2        1.2828             nan     0.1000    0.0177
     3        1.2497             nan     0.1000    0.0165
     4        1.2151             nan     0.1000    0.0168
     5        1.1878             nan     0.1000    0.0140
     6        1.1637             nan     0.1000    0.0123
     7        1.1420             nan     0.1000    0.0094
     8        1.1179             nan     0.1000    0.0092
     9        1.1032             nan     0.1000    0.0052
    10        1.0872             nan     0.1000    0.0057
    20        0.9565             nan     0.1000    0.0036
    40        0.8325             nan     0.1000    0.0015
    60        0.7803             nan     0.1000    0.0002
    80        0.7541             nan     0.1000   -0.0004
   100        0.7387             nan     0.1000   -0.0005
   120        0.7237             nan     0.1000   -0.0006
   140        0.7109             nan     0.1000   -0.0004
   160        0.7035             nan     0.1000   -0.0016
   180        0.6971             nan     0.1000   -0.0005
   200        0.6898             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3090             nan     0.1000    0.0304
     2        1.2585             nan     0.1000    0.0207
     3        1.1965             nan     0.1000    0.0262
     4        1.1530             nan     0.1000    0.0217
     5        1.1127             nan     0.1000    0.0169
     6        1.0857             nan     0.1000    0.0104
     7        1.0565             nan     0.1000    0.0132
     8        1.0281             nan     0.1000    0.0119
     9        1.0044             nan     0.1000    0.0117
    10        0.9823             nan     0.1000    0.0092
    20        0.8548             nan     0.1000    0.0023
    40        0.7508             nan     0.1000   -0.0010
    60        0.7056             nan     0.1000   -0.0006
    80        0.6730             nan     0.1000   -0.0007
   100        0.6475             nan     0.1000   -0.0007
   120        0.6261             nan     0.1000   -0.0012
   140        0.5999             nan     0.1000   -0.0009
   160        0.5826             nan     0.1000   -0.0020
   180        0.5651             nan     0.1000   -0.0009
   200        0.5497             nan     0.1000   -0.0015

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3042             nan     0.1000    0.0273
     2        1.2371             nan     0.1000    0.0333
     3        1.1847             nan     0.1000    0.0234
     4        1.1422             nan     0.1000    0.0176
     5        1.0962             nan     0.1000    0.0205
     6        1.0612             nan     0.1000    0.0152
     7        1.0327             nan     0.1000    0.0133
     8        1.0066             nan     0.1000    0.0101
     9        0.9797             nan     0.1000    0.0103
    10        0.9582             nan     0.1000    0.0084
    20        0.8148             nan     0.1000    0.0035
    40        0.7121             nan     0.1000   -0.0007
    60        0.6589             nan     0.1000   -0.0013
    80        0.6201             nan     0.1000   -0.0011
   100        0.5805             nan     0.1000   -0.0008
   120        0.5504             nan     0.1000   -0.0012
   140        0.5186             nan     0.1000   -0.0026
   160        0.4953             nan     0.1000   -0.0023
   180        0.4726             nan     0.1000   -0.0011
   200        0.4497             nan     0.1000   -0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3327             nan     0.1000    0.0219
     2        1.2951             nan     0.1000    0.0150
     3        1.2490             nan     0.1000    0.0189
     4        1.2189             nan     0.1000    0.0153
     5        1.1908             nan     0.1000    0.0146
     6        1.1630             nan     0.1000    0.0113
     7        1.1402             nan     0.1000    0.0100
     8        1.1222             nan     0.1000    0.0088
     9        1.1055             nan     0.1000    0.0084
    10        1.0900             nan     0.1000    0.0063
    20        0.9718             nan     0.1000    0.0034
    40        0.8547             nan     0.1000    0.0004
    60        0.7998             nan     0.1000   -0.0003
    80        0.7690             nan     0.1000   -0.0000
   100        0.7487             nan     0.1000   -0.0002
   120        0.7343             nan     0.1000   -0.0007
   140        0.7249             nan     0.1000   -0.0010
   160        0.7152             nan     0.1000   -0.0009
   180        0.7060             nan     0.1000   -0.0015
   200        0.6987             nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3062             nan     0.1000    0.0329
     2        1.2524             nan     0.1000    0.0255
     3        1.2132             nan     0.1000    0.0201
     4        1.1659             nan     0.1000    0.0218
     5        1.1323             nan     0.1000    0.0150
     6        1.0943             nan     0.1000    0.0168
     7        1.0661             nan     0.1000    0.0119
     8        1.0407             nan     0.1000    0.0113
     9        1.0167             nan     0.1000    0.0095
    10        0.9937             nan     0.1000    0.0084
    20        0.8592             nan     0.1000    0.0024
    40        0.7655             nan     0.1000    0.0003
    60        0.7128             nan     0.1000   -0.0004
    80        0.6822             nan     0.1000   -0.0020
   100        0.6586             nan     0.1000   -0.0008
   120        0.6370             nan     0.1000   -0.0013
   140        0.6158             nan     0.1000   -0.0021
   160        0.5977             nan     0.1000   -0.0016
   180        0.5852             nan     0.1000   -0.0012
   200        0.5726             nan     0.1000   -0.0015

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3062             nan     0.1000    0.0310
     2        1.2438             nan     0.1000    0.0272
     3        1.1900             nan     0.1000    0.0251
     4        1.1482             nan     0.1000    0.0186
     5        1.0962             nan     0.1000    0.0199
     6        1.0635             nan     0.1000    0.0117
     7        1.0370             nan     0.1000    0.0100
     8        1.0133             nan     0.1000    0.0098
     9        0.9824             nan     0.1000    0.0102
    10        0.9576             nan     0.1000    0.0107
    20        0.8220             nan     0.1000    0.0026
    40        0.7166             nan     0.1000    0.0003
    60        0.6604             nan     0.1000   -0.0011
    80        0.6228             nan     0.1000   -0.0014
   100        0.5885             nan     0.1000   -0.0017
   120        0.5581             nan     0.1000   -0.0013
   140        0.5305             nan     0.1000   -0.0008
   160        0.5047             nan     0.1000   -0.0015
   180        0.4821             nan     0.1000   -0.0006
   200        0.4625             nan     0.1000   -0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3276             nan     0.1000    0.0234
     2        1.2829             nan     0.1000    0.0203
     3        1.2487             nan     0.1000    0.0163
     4        1.2187             nan     0.1000    0.0128
     5        1.1916             nan     0.1000    0.0150
     6        1.1682             nan     0.1000    0.0098
     7        1.1449             nan     0.1000    0.0092
     8        1.1240             nan     0.1000    0.0093
     9        1.0969             nan     0.1000    0.0095
    10        1.0797             nan     0.1000    0.0073
    20        0.9530             nan     0.1000    0.0027
    40        0.8291             nan     0.1000    0.0005
    60        0.7787             nan     0.1000    0.0006
    80        0.7485             nan     0.1000    0.0000
   100        0.7252             nan     0.1000   -0.0017
   120        0.7103             nan     0.1000   -0.0006
   140        0.6988             nan     0.1000   -0.0009
   160        0.6893             nan     0.1000   -0.0004
   180        0.6831             nan     0.1000   -0.0016
   200        0.6748             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3102             nan     0.1000    0.0291
     2        1.2628             nan     0.1000    0.0221
     3        1.2052             nan     0.1000    0.0235
     4        1.1570             nan     0.1000    0.0239
     5        1.1178             nan     0.1000    0.0175
     6        1.0821             nan     0.1000    0.0171
     7        1.0509             nan     0.1000    0.0134
     8        1.0289             nan     0.1000    0.0090
     9        1.0053             nan     0.1000    0.0093
    10        0.9814             nan     0.1000    0.0116
    20        0.8431             nan     0.1000    0.0042
    40        0.7328             nan     0.1000   -0.0004
    60        0.6865             nan     0.1000   -0.0004
    80        0.6531             nan     0.1000   -0.0007
   100        0.6316             nan     0.1000   -0.0007
   120        0.6080             nan     0.1000   -0.0013
   140        0.5903             nan     0.1000   -0.0015
   160        0.5733             nan     0.1000   -0.0004
   180        0.5549             nan     0.1000   -0.0014
   200        0.5425             nan     0.1000   -0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3032             nan     0.1000    0.0326
     2        1.2448             nan     0.1000    0.0274
     3        1.1871             nan     0.1000    0.0277
     4        1.1495             nan     0.1000    0.0155
     5        1.1048             nan     0.1000    0.0194
     6        1.0725             nan     0.1000    0.0134
     7        1.0372             nan     0.1000    0.0159
     8        1.0053             nan     0.1000    0.0114
     9        0.9805             nan     0.1000    0.0099
    10        0.9570             nan     0.1000    0.0106
    20        0.8093             nan     0.1000    0.0018
    40        0.7000             nan     0.1000   -0.0005
    60        0.6416             nan     0.1000   -0.0004
    80        0.6005             nan     0.1000   -0.0015
   100        0.5692             nan     0.1000   -0.0031
   120        0.5424             nan     0.1000   -0.0014
   140        0.5038             nan     0.1000   -0.0021
   160        0.4776             nan     0.1000   -0.0015
   180        0.4510             nan     0.1000   -0.0012
   200        0.4298             nan     0.1000   -0.0019

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3246             nan     0.1000    0.0227
     2        1.2814             nan     0.1000    0.0233
     3        1.2429             nan     0.1000    0.0190
     4        1.2108             nan     0.1000    0.0161
     5        1.1805             nan     0.1000    0.0143
     6        1.1511             nan     0.1000    0.0145
     7        1.1329             nan     0.1000    0.0075
     8        1.1095             nan     0.1000    0.0104
     9        1.0876             nan     0.1000    0.0105
    10        1.0705             nan     0.1000    0.0069
    20        0.9403             nan     0.1000    0.0033
    40        0.8178             nan     0.1000    0.0005
    60        0.7676             nan     0.1000   -0.0007
    80        0.7397             nan     0.1000   -0.0001
   100        0.7218             nan     0.1000   -0.0004
   120        0.7081             nan     0.1000   -0.0031
   140        0.6947             nan     0.1000   -0.0006
   160        0.6847             nan     0.1000   -0.0008
   180        0.6772             nan     0.1000   -0.0007
   200        0.6707             nan     0.1000   -0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3092             nan     0.1000    0.0305
     2        1.2524             nan     0.1000    0.0244
     3        1.1948             nan     0.1000    0.0269
     4        1.1467             nan     0.1000    0.0225
     5        1.1083             nan     0.1000    0.0157
     6        1.0709             nan     0.1000    0.0182
     7        1.0452             nan     0.1000    0.0117
     8        1.0166             nan     0.1000    0.0138
     9        0.9894             nan     0.1000    0.0110
    10        0.9716             nan     0.1000    0.0082
    20        0.8334             nan     0.1000    0.0016
    40        0.7328             nan     0.1000    0.0007
    60        0.6871             nan     0.1000   -0.0004
    80        0.6576             nan     0.1000   -0.0022
   100        0.6317             nan     0.1000   -0.0014
   120        0.6105             nan     0.1000   -0.0008
   140        0.5963             nan     0.1000   -0.0022
   160        0.5785             nan     0.1000   -0.0007
   180        0.5602             nan     0.1000   -0.0005
   200        0.5478             nan     0.1000   -0.0015

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2992             nan     0.1000    0.0338
     2        1.2375             nan     0.1000    0.0275
     3        1.1782             nan     0.1000    0.0272
     4        1.1271             nan     0.1000    0.0226
     5        1.0813             nan     0.1000    0.0205
     6        1.0464             nan     0.1000    0.0149
     7        1.0117             nan     0.1000    0.0165
     8        0.9775             nan     0.1000    0.0140
     9        0.9501             nan     0.1000    0.0103
    10        0.9295             nan     0.1000    0.0086
    20        0.7933             nan     0.1000    0.0012
    40        0.6930             nan     0.1000    0.0002
    60        0.6402             nan     0.1000   -0.0017
    80        0.6085             nan     0.1000   -0.0026
   100        0.5653             nan     0.1000   -0.0008
   120        0.5333             nan     0.1000   -0.0016
   140        0.5140             nan     0.1000   -0.0011
   160        0.4845             nan     0.1000   -0.0008
   180        0.4630             nan     0.1000   -0.0007
   200        0.4406             nan     0.1000   -0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3265             nan     0.1000    0.0217
     2        1.2809             nan     0.1000    0.0224
     3        1.2376             nan     0.1000    0.0177
     4        1.2049             nan     0.1000    0.0164
     5        1.1769             nan     0.1000    0.0133
     6        1.1542             nan     0.1000    0.0124
     7        1.1296             nan     0.1000    0.0117
     8        1.1122             nan     0.1000    0.0076
     9        1.0910             nan     0.1000    0.0082
    10        1.0742             nan     0.1000    0.0075
    20        0.9493             nan     0.1000    0.0032
    40        0.8293             nan     0.1000    0.0010
    60        0.7758             nan     0.1000    0.0002
    80        0.7474             nan     0.1000   -0.0005
   100        0.7293             nan     0.1000   -0.0014
   120        0.7171             nan     0.1000   -0.0011
   140        0.7058             nan     0.1000   -0.0013
   160        0.6971             nan     0.1000   -0.0012
   180        0.6903             nan     0.1000   -0.0006
   200        0.6852             nan     0.1000    0.0000

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3126             nan     0.1000    0.0301
     2        1.2557             nan     0.1000    0.0245
     3        1.2013             nan     0.1000    0.0271
     4        1.1495             nan     0.1000    0.0237
     5        1.1112             nan     0.1000    0.0177
     6        1.0856             nan     0.1000    0.0116
     7        1.0575             nan     0.1000    0.0126
     8        1.0347             nan     0.1000    0.0106
     9        1.0062             nan     0.1000    0.0134
    10        0.9801             nan     0.1000    0.0105
    20        0.8526             nan     0.1000    0.0028
    40        0.7456             nan     0.1000   -0.0008
    60        0.7015             nan     0.1000   -0.0002
    80        0.6727             nan     0.1000   -0.0013
   100        0.6431             nan     0.1000   -0.0005
   120        0.6229             nan     0.1000   -0.0009
   140        0.6053             nan     0.1000   -0.0014
   160        0.5866             nan     0.1000   -0.0015
   180        0.5737             nan     0.1000   -0.0004
   200        0.5587             nan     0.1000    0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3090             nan     0.1000    0.0294
     2        1.2460             nan     0.1000    0.0321
     3        1.1854             nan     0.1000    0.0283
     4        1.1403             nan     0.1000    0.0214
     5        1.1020             nan     0.1000    0.0149
     6        1.0610             nan     0.1000    0.0170
     7        1.0295             nan     0.1000    0.0110
     8        1.0047             nan     0.1000    0.0105
     9        0.9754             nan     0.1000    0.0119
    10        0.9478             nan     0.1000    0.0119
    20        0.8074             nan     0.1000    0.0038
    40        0.7029             nan     0.1000    0.0001
    60        0.6504             nan     0.1000   -0.0011
    80        0.6100             nan     0.1000   -0.0009
   100        0.5820             nan     0.1000   -0.0020
   120        0.5504             nan     0.1000   -0.0010
   140        0.5255             nan     0.1000   -0.0023
   160        0.4988             nan     0.1000   -0.0016
   180        0.4792             nan     0.1000   -0.0015
   200        0.4630             nan     0.1000   -0.0016

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3247             nan     0.1000    0.0220
     2        1.2882             nan     0.1000    0.0166
     3        1.2462             nan     0.1000    0.0193
     4        1.2129             nan     0.1000    0.0154
     5        1.1865             nan     0.1000    0.0118
     6        1.1603             nan     0.1000    0.0118
     7        1.1398             nan     0.1000    0.0094
     8        1.1174             nan     0.1000    0.0113
     9        1.0981             nan     0.1000    0.0079
    10        1.0781             nan     0.1000    0.0086
    20        0.9491             nan     0.1000    0.0043
    40        0.8274             nan     0.1000    0.0017
    60        0.7742             nan     0.1000    0.0002
    80        0.7491             nan     0.1000   -0.0014
   100        0.7311             nan     0.1000   -0.0006
   120        0.7158             nan     0.1000   -0.0004
   140        0.7054             nan     0.1000   -0.0017
   160        0.6978             nan     0.1000   -0.0014
   180        0.6906             nan     0.1000   -0.0008
   200        0.6849             nan     0.1000   -0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3194             nan     0.1000    0.0292
     2        1.2535             nan     0.1000    0.0323
     3        1.1987             nan     0.1000    0.0269
     4        1.1494             nan     0.1000    0.0235
     5        1.1132             nan     0.1000    0.0156
     6        1.0779             nan     0.1000    0.0176
     7        1.0520             nan     0.1000    0.0107
     8        1.0275             nan     0.1000    0.0109
     9        1.0014             nan     0.1000    0.0121
    10        0.9777             nan     0.1000    0.0121
    20        0.8336             nan     0.1000    0.0039
    40        0.7304             nan     0.1000   -0.0007
    60        0.6808             nan     0.1000   -0.0015
    80        0.6511             nan     0.1000   -0.0011
   100        0.6270             nan     0.1000   -0.0007
   120        0.6018             nan     0.1000   -0.0012
   140        0.5842             nan     0.1000   -0.0021
   160        0.5649             nan     0.1000   -0.0013
   180        0.5500             nan     0.1000   -0.0001
   200        0.5373             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3061             nan     0.1000    0.0325
     2        1.2392             nan     0.1000    0.0307
     3        1.1796             nan     0.1000    0.0294
     4        1.1371             nan     0.1000    0.0192
     5        1.0907             nan     0.1000    0.0206
     6        1.0510             nan     0.1000    0.0183
     7        1.0174             nan     0.1000    0.0151
     8        0.9894             nan     0.1000    0.0117
     9        0.9610             nan     0.1000    0.0127
    10        0.9366             nan     0.1000    0.0077
    20        0.7978             nan     0.1000    0.0001
    40        0.6835             nan     0.1000   -0.0025
    60        0.6316             nan     0.1000   -0.0027
    80        0.5927             nan     0.1000   -0.0016
   100        0.5573             nan     0.1000   -0.0011
   120        0.5271             nan     0.1000   -0.0017
   140        0.5015             nan     0.1000   -0.0007
   160        0.4773             nan     0.1000   -0.0019
   180        0.4521             nan     0.1000   -0.0015
   200        0.4304             nan     0.1000   -0.0017

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3285             nan     0.1000    0.0231
     2        1.2897             nan     0.1000    0.0177
     3        1.2499             nan     0.1000    0.0180
     4        1.2162             nan     0.1000    0.0158
     5        1.1863             nan     0.1000    0.0133
     6        1.1676             nan     0.1000    0.0070
     7        1.1443             nan     0.1000    0.0110
     8        1.1275             nan     0.1000    0.0067
     9        1.1081             nan     0.1000    0.0088
    10        1.0918             nan     0.1000    0.0065
    20        0.9580             nan     0.1000    0.0038
    40        0.8335             nan     0.1000    0.0017
    60        0.7827             nan     0.1000   -0.0001
    80        0.7513             nan     0.1000   -0.0005
   100        0.7288             nan     0.1000   -0.0001
   120        0.7169             nan     0.1000   -0.0017
   140        0.7050             nan     0.1000   -0.0003
   160        0.6960             nan     0.1000   -0.0003
   180        0.6885             nan     0.1000   -0.0008
   200        0.6820             nan     0.1000   -0.0003

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3136             nan     0.1000    0.0293
     2        1.2545             nan     0.1000    0.0293
     3        1.2050             nan     0.1000    0.0233
     4        1.1679             nan     0.1000    0.0181
     5        1.1332             nan     0.1000    0.0154
     6        1.0976             nan     0.1000    0.0164
     7        1.0628             nan     0.1000    0.0152
     8        1.0388             nan     0.1000    0.0089
     9        1.0132             nan     0.1000    0.0103
    10        0.9961             nan     0.1000    0.0071
    20        0.8553             nan     0.1000    0.0019
    40        0.7480             nan     0.1000    0.0003
    60        0.7024             nan     0.1000   -0.0004
    80        0.6725             nan     0.1000   -0.0011
   100        0.6477             nan     0.1000   -0.0011
   120        0.6234             nan     0.1000   -0.0020
   140        0.6067             nan     0.1000   -0.0001
   160        0.5878             nan     0.1000   -0.0006
   180        0.5734             nan     0.1000   -0.0015
   200        0.5618             nan     0.1000   -0.0017

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2977             nan     0.1000    0.0349
     2        1.2337             nan     0.1000    0.0263
     3        1.1780             nan     0.1000    0.0263
     4        1.1369             nan     0.1000    0.0191
     5        1.0961             nan     0.1000    0.0198
     6        1.0582             nan     0.1000    0.0174
     7        1.0269             nan     0.1000    0.0133
     8        1.0030             nan     0.1000    0.0072
     9        0.9768             nan     0.1000    0.0121
    10        0.9489             nan     0.1000    0.0108
    20        0.8087             nan     0.1000    0.0024
    40        0.7048             nan     0.1000   -0.0017
    60        0.6551             nan     0.1000   -0.0013
    80        0.6141             nan     0.1000   -0.0014
   100        0.5769             nan     0.1000   -0.0018
   120        0.5459             nan     0.1000   -0.0018
   140        0.5177             nan     0.1000   -0.0014
   160        0.4929             nan     0.1000   -0.0006
   180        0.4695             nan     0.1000   -0.0016
   200        0.4492             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3256             nan     0.1000    0.0227
     2        1.2828             nan     0.1000    0.0168
     3        1.2468             nan     0.1000    0.0176
     4        1.2172             nan     0.1000    0.0143
     5        1.1902             nan     0.1000    0.0110
     6        1.1631             nan     0.1000    0.0138
     7        1.1417             nan     0.1000    0.0091
     8        1.1203             nan     0.1000    0.0091
     9        1.0964             nan     0.1000    0.0099
    10        1.0803             nan     0.1000    0.0064
    20        0.9495             nan     0.1000    0.0035
    40        0.8312             nan     0.1000   -0.0005
    60        0.7812             nan     0.1000   -0.0012
    80        0.7553             nan     0.1000   -0.0013
   100        0.7354             nan     0.1000   -0.0003
   120        0.7223             nan     0.1000   -0.0014
   140        0.7125             nan     0.1000   -0.0008
   160        0.7050             nan     0.1000   -0.0014
   180        0.6976             nan     0.1000   -0.0016
   200        0.6907             nan     0.1000   -0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3052             nan     0.1000    0.0339
     2        1.2475             nan     0.1000    0.0276
     3        1.2034             nan     0.1000    0.0216
     4        1.1577             nan     0.1000    0.0232
     5        1.1252             nan     0.1000    0.0153
     6        1.0983             nan     0.1000    0.0142
     7        1.0731             nan     0.1000    0.0120
     8        1.0410             nan     0.1000    0.0156
     9        1.0139             nan     0.1000    0.0127
    10        0.9934             nan     0.1000    0.0091
    20        0.8467             nan     0.1000    0.0024
    40        0.7434             nan     0.1000    0.0006
    60        0.6981             nan     0.1000   -0.0012
    80        0.6708             nan     0.1000   -0.0007
   100        0.6479             nan     0.1000   -0.0007
   120        0.6286             nan     0.1000   -0.0008
   140        0.6075             nan     0.1000   -0.0015
   160        0.5871             nan     0.1000   -0.0011
   180        0.5739             nan     0.1000   -0.0014
   200        0.5587             nan     0.1000   -0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2966             nan     0.1000    0.0354
     2        1.2301             nan     0.1000    0.0323
     3        1.1735             nan     0.1000    0.0252
     4        1.1323             nan     0.1000    0.0189
     5        1.0876             nan     0.1000    0.0212
     6        1.0502             nan     0.1000    0.0145
     7        1.0154             nan     0.1000    0.0143
     8        0.9882             nan     0.1000    0.0118
     9        0.9647             nan     0.1000    0.0103
    10        0.9448             nan     0.1000    0.0065
    20        0.8088             nan     0.1000    0.0017
    40        0.7081             nan     0.1000   -0.0010
    60        0.6553             nan     0.1000    0.0001
    80        0.6169             nan     0.1000   -0.0031
   100        0.5821             nan     0.1000   -0.0016
   120        0.5500             nan     0.1000   -0.0021
   140        0.5252             nan     0.1000   -0.0020
   160        0.4972             nan     0.1000   -0.0019
   180        0.4737             nan     0.1000   -0.0012
   200        0.4535             nan     0.1000   -0.0022

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3274             nan     0.1000    0.0209
     2        1.2911             nan     0.1000    0.0164
     3        1.2527             nan     0.1000    0.0181
     4        1.2233             nan     0.1000    0.0145
     5        1.1926             nan     0.1000    0.0137
     6        1.1653             nan     0.1000    0.0099
     7        1.1469             nan     0.1000    0.0067
     8        1.1265             nan     0.1000    0.0101
     9        1.1085             nan     0.1000    0.0085
    10        1.0920             nan     0.1000    0.0061
    20        0.9699             nan     0.1000    0.0042
    40        0.8576             nan     0.1000    0.0016
    60        0.8055             nan     0.1000   -0.0008
    80        0.7843             nan     0.1000   -0.0000
   100        0.7668             nan     0.1000   -0.0012
   120        0.7532             nan     0.1000   -0.0001
   140        0.7455             nan     0.1000   -0.0020
   160        0.7361             nan     0.1000   -0.0008
   180        0.7276             nan     0.1000   -0.0010
   200        0.7226             nan     0.1000   -0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3205             nan     0.1000    0.0276
     2        1.2641             nan     0.1000    0.0291
     3        1.2162             nan     0.1000    0.0246
     4        1.1774             nan     0.1000    0.0176
     5        1.1441             nan     0.1000    0.0157
     6        1.1051             nan     0.1000    0.0174
     7        1.0734             nan     0.1000    0.0149
     8        1.0521             nan     0.1000    0.0076
     9        1.0318             nan     0.1000    0.0102
    10        1.0155             nan     0.1000    0.0066
    20        0.8800             nan     0.1000    0.0029
    40        0.7723             nan     0.1000   -0.0004
    60        0.7211             nan     0.1000   -0.0013
    80        0.6956             nan     0.1000   -0.0015
   100        0.6748             nan     0.1000   -0.0012
   120        0.6535             nan     0.1000   -0.0020
   140        0.6349             nan     0.1000   -0.0007
   160        0.6172             nan     0.1000   -0.0013
   180        0.5984             nan     0.1000   -0.0013
   200        0.5837             nan     0.1000   -0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3086             nan     0.1000    0.0323
     2        1.2422             nan     0.1000    0.0289
     3        1.1858             nan     0.1000    0.0266
     4        1.1453             nan     0.1000    0.0179
     5        1.1043             nan     0.1000    0.0199
     6        1.0665             nan     0.1000    0.0145
     7        1.0330             nan     0.1000    0.0131
     8        1.0069             nan     0.1000    0.0118
     9        0.9864             nan     0.1000    0.0085
    10        0.9626             nan     0.1000    0.0079
    20        0.8311             nan     0.1000    0.0006
    40        0.7238             nan     0.1000   -0.0021
    60        0.6738             nan     0.1000   -0.0017
    80        0.6346             nan     0.1000   -0.0005
   100        0.6011             nan     0.1000   -0.0001
   120        0.5773             nan     0.1000   -0.0022
   140        0.5508             nan     0.1000   -0.0013
   160        0.5282             nan     0.1000   -0.0026
   180        0.5064             nan     0.1000   -0.0015
   200        0.4872             nan     0.1000   -0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3297             nan     0.1000    0.0219
     2        1.2928             nan     0.1000    0.0177
     3        1.2639             nan     0.1000    0.0142
     4        1.2224             nan     0.1000    0.0169
     5        1.1933             nan     0.1000    0.0153
     6        1.1642             nan     0.1000    0.0125
     7        1.1433             nan     0.1000    0.0090
     8        1.1209             nan     0.1000    0.0112
     9        1.1024             nan     0.1000    0.0074
    10        1.0835             nan     0.1000    0.0096
    20        0.9478             nan     0.1000    0.0050
    40        0.8238             nan     0.1000    0.0014
    60        0.7648             nan     0.1000    0.0000
    80        0.7349             nan     0.1000   -0.0006
   100        0.7125             nan     0.1000   -0.0005
   120        0.6991             nan     0.1000   -0.0008
   140        0.6877             nan     0.1000   -0.0008
   160        0.6763             nan     0.1000   -0.0004
   180        0.6672             nan     0.1000   -0.0005
   200        0.6620             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3180             nan     0.1000    0.0280
     2        1.2569             nan     0.1000    0.0298
     3        1.2068             nan     0.1000    0.0239
     4        1.1636             nan     0.1000    0.0207
     5        1.1288             nan     0.1000    0.0166
     6        1.0967             nan     0.1000    0.0132
     7        1.0602             nan     0.1000    0.0164
     8        1.0339             nan     0.1000    0.0098
     9        1.0115             nan     0.1000    0.0078
    10        0.9862             nan     0.1000    0.0116
    20        0.8367             nan     0.1000    0.0020
    40        0.7313             nan     0.1000    0.0003
    60        0.6825             nan     0.1000    0.0002
    80        0.6456             nan     0.1000   -0.0007
   100        0.6239             nan     0.1000   -0.0010
   120        0.6027             nan     0.1000   -0.0018
   140        0.5874             nan     0.1000   -0.0025
   160        0.5677             nan     0.1000   -0.0011
   180        0.5531             nan     0.1000   -0.0015
   200        0.5350             nan     0.1000   -0.0021

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3008             nan     0.1000    0.0326
     2        1.2431             nan     0.1000    0.0276
     3        1.1856             nan     0.1000    0.0281
     4        1.1396             nan     0.1000    0.0223
     5        1.0963             nan     0.1000    0.0185
     6        1.0619             nan     0.1000    0.0134
     7        1.0329             nan     0.1000    0.0135
     8        1.0040             nan     0.1000    0.0118
     9        0.9796             nan     0.1000    0.0109
    10        0.9565             nan     0.1000    0.0091
    20        0.8035             nan     0.1000    0.0037
    40        0.6878             nan     0.1000   -0.0007
    60        0.6347             nan     0.1000   -0.0013
    80        0.5976             nan     0.1000   -0.0016
   100        0.5633             nan     0.1000   -0.0030
   120        0.5307             nan     0.1000   -0.0015
   140        0.5047             nan     0.1000   -0.0026
   160        0.4717             nan     0.1000   -0.0014
   180        0.4497             nan     0.1000   -0.0019
   200        0.4321             nan     0.1000   -0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3280             nan     0.1000    0.0243
     2        1.2874             nan     0.1000    0.0212
     3        1.2496             nan     0.1000    0.0177
     4        1.2150             nan     0.1000    0.0160
     5        1.1878             nan     0.1000    0.0112
     6        1.1627             nan     0.1000    0.0128
     7        1.1328             nan     0.1000    0.0120
     8        1.1135             nan     0.1000    0.0082
     9        1.0922             nan     0.1000    0.0088
    10        1.0726             nan     0.1000    0.0090
    20        0.9424             nan     0.1000    0.0026
    40        0.8220             nan     0.1000    0.0005
    60        0.7725             nan     0.1000   -0.0001
    80        0.7439             nan     0.1000   -0.0003
   100        0.7255             nan     0.1000   -0.0007
   120        0.7082             nan     0.1000    0.0000
   140        0.6962             nan     0.1000   -0.0006
   160        0.6889             nan     0.1000   -0.0016
   180        0.6803             nan     0.1000   -0.0026
   200        0.6741             nan     0.1000   -0.0001

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3032             nan     0.1000    0.0321
     2        1.2495             nan     0.1000    0.0261
     3        1.1946             nan     0.1000    0.0265
     4        1.1503             nan     0.1000    0.0215
     5        1.1113             nan     0.1000    0.0168
     6        1.0743             nan     0.1000    0.0182
     7        1.0468             nan     0.1000    0.0121
     8        1.0194             nan     0.1000    0.0114
     9        0.9929             nan     0.1000    0.0126
    10        0.9701             nan     0.1000    0.0087
    20        0.8317             nan     0.1000    0.0026
    40        0.7289             nan     0.1000   -0.0008
    60        0.6785             nan     0.1000   -0.0010
    80        0.6424             nan     0.1000   -0.0006
   100        0.6126             nan     0.1000   -0.0010
   120        0.5907             nan     0.1000   -0.0007
   140        0.5717             nan     0.1000   -0.0007
   160        0.5540             nan     0.1000   -0.0023
   180        0.5363             nan     0.1000   -0.0003
   200        0.5234             nan     0.1000   -0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3034             nan     0.1000    0.0290
     2        1.2438             nan     0.1000    0.0271
     3        1.1840             nan     0.1000    0.0289
     4        1.1393             nan     0.1000    0.0207
     5        1.0954             nan     0.1000    0.0214
     6        1.0641             nan     0.1000    0.0136
     7        1.0355             nan     0.1000    0.0130
     8        1.0023             nan     0.1000    0.0157
     9        0.9713             nan     0.1000    0.0134
    10        0.9448             nan     0.1000    0.0116
    20        0.7953             nan     0.1000    0.0020
    40        0.6892             nan     0.1000   -0.0003
    60        0.6299             nan     0.1000   -0.0029
    80        0.5888             nan     0.1000   -0.0008
   100        0.5536             nan     0.1000   -0.0002
   120        0.5300             nan     0.1000   -0.0018
   140        0.5065             nan     0.1000   -0.0029
   160        0.4800             nan     0.1000   -0.0020
   180        0.4535             nan     0.1000   -0.0013
   200        0.4343             nan     0.1000   -0.0016

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3321             nan     0.1000    0.0229
     2        1.2877             nan     0.1000    0.0220
     3        1.2515             nan     0.1000    0.0154
     4        1.2202             nan     0.1000    0.0163
     5        1.1909             nan     0.1000    0.0135
     6        1.1622             nan     0.1000    0.0134
     7        1.1438             nan     0.1000    0.0080
     8        1.1230             nan     0.1000    0.0092
     9        1.1047             nan     0.1000    0.0059
    10        1.0842             nan     0.1000    0.0084
    20        0.9459             nan     0.1000    0.0035
    40        0.8186             nan     0.1000    0.0007
    60        0.7682             nan     0.1000   -0.0006
    80        0.7336             nan     0.1000   -0.0004
   100        0.7140             nan     0.1000   -0.0007
   120        0.7009             nan     0.1000   -0.0006
   140        0.6916             nan     0.1000   -0.0004
   160        0.6828             nan     0.1000   -0.0007
   180        0.6758             nan     0.1000   -0.0008
   200        0.6708             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3113             nan     0.1000    0.0299
     2        1.2551             nan     0.1000    0.0280
     3        1.2112             nan     0.1000    0.0215
     4        1.1695             nan     0.1000    0.0175
     5        1.1263             nan     0.1000    0.0200
     6        1.0829             nan     0.1000    0.0198
     7        1.0473             nan     0.1000    0.0156
     8        1.0225             nan     0.1000    0.0114
     9        0.9943             nan     0.1000    0.0104
    10        0.9742             nan     0.1000    0.0086
    20        0.8374             nan     0.1000    0.0030
    40        0.7311             nan     0.1000   -0.0009
    60        0.6826             nan     0.1000   -0.0005
    80        0.6523             nan     0.1000   -0.0010
   100        0.6239             nan     0.1000   -0.0013
   120        0.5994             nan     0.1000   -0.0010
   140        0.5846             nan     0.1000   -0.0014
   160        0.5693             nan     0.1000   -0.0012
   180        0.5502             nan     0.1000   -0.0003
   200        0.5375             nan     0.1000   -0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2994             nan     0.1000    0.0359
     2        1.2414             nan     0.1000    0.0279
     3        1.1868             nan     0.1000    0.0258
     4        1.1356             nan     0.1000    0.0232
     5        1.0925             nan     0.1000    0.0162
     6        1.0506             nan     0.1000    0.0201
     7        1.0207             nan     0.1000    0.0140
     8        0.9918             nan     0.1000    0.0117
     9        0.9657             nan     0.1000    0.0109
    10        0.9439             nan     0.1000    0.0086
    20        0.7985             nan     0.1000    0.0031
    40        0.6842             nan     0.1000   -0.0034
    60        0.6322             nan     0.1000    0.0001
    80        0.5948             nan     0.1000   -0.0022
   100        0.5591             nan     0.1000   -0.0010
   120        0.5288             nan     0.1000   -0.0027
   140        0.5066             nan     0.1000   -0.0021
   160        0.4863             nan     0.1000   -0.0025
   180        0.4636             nan     0.1000   -0.0016
   200        0.4461             nan     0.1000   -0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3286             nan     0.1000    0.0239
     2        1.2873             nan     0.1000    0.0192
     3        1.2479             nan     0.1000    0.0187
     4        1.2161             nan     0.1000    0.0154
     5        1.1891             nan     0.1000    0.0120
     6        1.1632             nan     0.1000    0.0108
     7        1.1405             nan     0.1000    0.0076
     8        1.1176             nan     0.1000    0.0110
     9        1.0991             nan     0.1000    0.0087
    10        1.0792             nan     0.1000    0.0080
    20        0.9553             nan     0.1000    0.0038
    40        0.8355             nan     0.1000   -0.0008
    60        0.7830             nan     0.1000   -0.0009
    80        0.7527             nan     0.1000   -0.0004
   100        0.7351             nan     0.1000   -0.0003
   120        0.7209             nan     0.1000   -0.0012
   140        0.7072             nan     0.1000   -0.0005
   160        0.6978             nan     0.1000   -0.0006
   180        0.6904             nan     0.1000   -0.0011
   200        0.6856             nan     0.1000   -0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3153             nan     0.1000    0.0270
     2        1.2629             nan     0.1000    0.0209
     3        1.2103             nan     0.1000    0.0268
     4        1.1687             nan     0.1000    0.0178
     5        1.1240             nan     0.1000    0.0217
     6        1.0955             nan     0.1000    0.0129
     7        1.0570             nan     0.1000    0.0147
     8        1.0407             nan     0.1000    0.0061
     9        1.0127             nan     0.1000    0.0138
    10        0.9912             nan     0.1000    0.0077
    20        0.8456             nan     0.1000    0.0036
    40        0.7436             nan     0.1000   -0.0006
    60        0.6944             nan     0.1000   -0.0005
    80        0.6599             nan     0.1000   -0.0009
   100        0.6295             nan     0.1000   -0.0003
   120        0.6080             nan     0.1000   -0.0003
   140        0.5886             nan     0.1000   -0.0018
   160        0.5742             nan     0.1000   -0.0016
   180        0.5594             nan     0.1000   -0.0012
   200        0.5441             nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3023             nan     0.1000    0.0319
     2        1.2365             nan     0.1000    0.0304
     3        1.1806             nan     0.1000    0.0261
     4        1.1379             nan     0.1000    0.0191
     5        1.1010             nan     0.1000    0.0172
     6        1.0682             nan     0.1000    0.0136
     7        1.0328             nan     0.1000    0.0172
     8        1.0001             nan     0.1000    0.0144
     9        0.9802             nan     0.1000    0.0076
    10        0.9565             nan     0.1000    0.0107
    20        0.8137             nan     0.1000    0.0025
    40        0.7005             nan     0.1000   -0.0010
    60        0.6403             nan     0.1000   -0.0005
    80        0.5993             nan     0.1000   -0.0003
   100        0.5645             nan     0.1000   -0.0010
   120        0.5341             nan     0.1000   -0.0006
   140        0.4983             nan     0.1000   -0.0012
   160        0.4715             nan     0.1000   -0.0017
   180        0.4489             nan     0.1000   -0.0010
   200        0.4299             nan     0.1000   -0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3295             nan     0.1000    0.0212
     2        1.2906             nan     0.1000    0.0191
     3        1.2572             nan     0.1000    0.0158
     4        1.2246             nan     0.1000    0.0182
     5        1.1907             nan     0.1000    0.0152
     6        1.1654             nan     0.1000    0.0126
     7        1.1425             nan     0.1000    0.0103
     8        1.1248             nan     0.1000    0.0083
     9        1.1020             nan     0.1000    0.0104
    10        1.0850             nan     0.1000    0.0087
    20        0.9557             nan     0.1000    0.0023
    40        0.8324             nan     0.1000    0.0006
    60        0.7812             nan     0.1000   -0.0010
    80        0.7574             nan     0.1000   -0.0005
   100        0.7367             nan     0.1000   -0.0011
   120        0.7243             nan     0.1000   -0.0014
   140        0.7153             nan     0.1000   -0.0004
   160        0.7055             nan     0.1000   -0.0007
   180        0.6998             nan     0.1000   -0.0011
   200        0.6940             nan     0.1000   -0.0003

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3125             nan     0.1000    0.0301
     2        1.2504             nan     0.1000    0.0294
     3        1.2073             nan     0.1000    0.0203
     4        1.1622             nan     0.1000    0.0197
     5        1.1227             nan     0.1000    0.0176
     6        1.0841             nan     0.1000    0.0182
     7        1.0498             nan     0.1000    0.0163
     8        1.0265             nan     0.1000    0.0090
     9        1.0039             nan     0.1000    0.0083
    10        0.9791             nan     0.1000    0.0121
    20        0.8424             nan     0.1000    0.0037
    40        0.7400             nan     0.1000    0.0007
    60        0.6995             nan     0.1000   -0.0006
    80        0.6712             nan     0.1000   -0.0009
   100        0.6421             nan     0.1000   -0.0006
   120        0.6199             nan     0.1000   -0.0006
   140        0.5959             nan     0.1000   -0.0021
   160        0.5748             nan     0.1000   -0.0018
   180        0.5572             nan     0.1000   -0.0016
   200        0.5448             nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3027             nan     0.1000    0.0342
     2        1.2327             nan     0.1000    0.0317
     3        1.1828             nan     0.1000    0.0228
     4        1.1332             nan     0.1000    0.0244
     5        1.0961             nan     0.1000    0.0167
     6        1.0557             nan     0.1000    0.0172
     7        1.0184             nan     0.1000    0.0154
     8        0.9858             nan     0.1000    0.0134
     9        0.9641             nan     0.1000    0.0078
    10        0.9431             nan     0.1000    0.0102
    20        0.8007             nan     0.1000    0.0029
    40        0.6960             nan     0.1000   -0.0002
    60        0.6424             nan     0.1000   -0.0019
    80        0.6054             nan     0.1000   -0.0019
   100        0.5726             nan     0.1000   -0.0031
   120        0.5437             nan     0.1000   -0.0027
   140        0.5166             nan     0.1000   -0.0006
   160        0.4916             nan     0.1000   -0.0019
   180        0.4710             nan     0.1000   -0.0011
   200        0.4489             nan     0.1000   -0.0022

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3258             nan     0.1000    0.0227
     2        1.2900             nan     0.1000    0.0185
     3        1.2514             nan     0.1000    0.0180
     4        1.2184             nan     0.1000    0.0162
     5        1.1876             nan     0.1000    0.0141
     6        1.1567             nan     0.1000    0.0104
     7        1.1359             nan     0.1000    0.0063
     8        1.1159             nan     0.1000    0.0090
     9        1.0978             nan     0.1000    0.0088
    10        1.0805             nan     0.1000    0.0075
    20        0.9586             nan     0.1000    0.0030
    40        0.8390             nan     0.1000    0.0004
    60        0.7838             nan     0.1000    0.0004
    80        0.7511             nan     0.1000   -0.0014
   100        0.7301             nan     0.1000   -0.0001
   120        0.7153             nan     0.1000   -0.0005
   140        0.7068             nan     0.1000   -0.0013
   160        0.6973             nan     0.1000   -0.0007
   180        0.6909             nan     0.1000   -0.0009
   200        0.6841             nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3089             nan     0.1000    0.0329
     2        1.2564             nan     0.1000    0.0230
     3        1.2140             nan     0.1000    0.0187
     4        1.1714             nan     0.1000    0.0201
     5        1.1248             nan     0.1000    0.0200
     6        1.0901             nan     0.1000    0.0165
     7        1.0629             nan     0.1000    0.0128
     8        1.0364             nan     0.1000    0.0104
     9        1.0101             nan     0.1000    0.0130
    10        0.9897             nan     0.1000    0.0076
    20        0.8531             nan     0.1000    0.0019
    40        0.7459             nan     0.1000   -0.0004
    60        0.6975             nan     0.1000   -0.0008
    80        0.6622             nan     0.1000   -0.0009
   100        0.6355             nan     0.1000   -0.0024
   120        0.6136             nan     0.1000   -0.0022
   140        0.5909             nan     0.1000   -0.0005
   160        0.5746             nan     0.1000   -0.0009
   180        0.5618             nan     0.1000   -0.0008
   200        0.5463             nan     0.1000   -0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2983             nan     0.1000    0.0335
     2        1.2344             nan     0.1000    0.0295
     3        1.1776             nan     0.1000    0.0258
     4        1.1282             nan     0.1000    0.0224
     5        1.0910             nan     0.1000    0.0171
     6        1.0524             nan     0.1000    0.0159
     7        1.0212             nan     0.1000    0.0127
     8        0.9978             nan     0.1000    0.0112
     9        0.9720             nan     0.1000    0.0097
    10        0.9518             nan     0.1000    0.0072
    20        0.8088             nan     0.1000    0.0006
    40        0.6944             nan     0.1000   -0.0006
    60        0.6442             nan     0.1000   -0.0010
    80        0.6067             nan     0.1000   -0.0008
   100        0.5788             nan     0.1000   -0.0010
   120        0.5456             nan     0.1000   -0.0026
   140        0.5201             nan     0.1000   -0.0011
   160        0.4982             nan     0.1000   -0.0008
   180        0.4749             nan     0.1000   -0.0023
   200        0.4528             nan     0.1000   -0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3265             nan     0.1000    0.0232
     2        1.2816             nan     0.1000    0.0218
     3        1.2463             nan     0.1000    0.0175
     4        1.2151             nan     0.1000    0.0159
     5        1.1863             nan     0.1000    0.0138
     6        1.1598             nan     0.1000    0.0119
     7        1.1305             nan     0.1000    0.0100
     8        1.1082             nan     0.1000    0.0092
     9        1.0899             nan     0.1000    0.0084
    10        1.0737             nan     0.1000    0.0072
    20        0.9471             nan     0.1000    0.0036
    40        0.8259             nan     0.1000   -0.0003
    60        0.7777             nan     0.1000   -0.0002
    80        0.7476             nan     0.1000   -0.0001
   100        0.7317             nan     0.1000   -0.0007
   120        0.7204             nan     0.1000   -0.0005
   140        0.7102             nan     0.1000   -0.0016
   160        0.7018             nan     0.1000   -0.0009
   180        0.6929             nan     0.1000   -0.0007
   200        0.6878             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3156             nan     0.1000    0.0292
     2        1.2505             nan     0.1000    0.0299
     3        1.1939             nan     0.1000    0.0255
     4        1.1518             nan     0.1000    0.0177
     5        1.1102             nan     0.1000    0.0185
     6        1.0744             nan     0.1000    0.0162
     7        1.0429             nan     0.1000    0.0148
     8        1.0206             nan     0.1000    0.0101
     9        0.9969             nan     0.1000    0.0098
    10        0.9770             nan     0.1000    0.0085
    20        0.8354             nan     0.1000    0.0028
    40        0.7314             nan     0.1000    0.0005
    60        0.6911             nan     0.1000   -0.0005
    80        0.6606             nan     0.1000   -0.0005
   100        0.6414             nan     0.1000   -0.0010
   120        0.6228             nan     0.1000   -0.0006
   140        0.6025             nan     0.1000   -0.0013
   160        0.5818             nan     0.1000   -0.0027
   180        0.5635             nan     0.1000   -0.0005
   200        0.5486             nan     0.1000   -0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2955             nan     0.1000    0.0352
     2        1.2384             nan     0.1000    0.0268
     3        1.1832             nan     0.1000    0.0258
     4        1.1341             nan     0.1000    0.0231
     5        1.0980             nan     0.1000    0.0151
     6        1.0565             nan     0.1000    0.0187
     7        1.0172             nan     0.1000    0.0171
     8        0.9896             nan     0.1000    0.0117
     9        0.9672             nan     0.1000    0.0104
    10        0.9405             nan     0.1000    0.0097
    20        0.8045             nan     0.1000    0.0006
    40        0.6919             nan     0.1000    0.0004
    60        0.6408             nan     0.1000   -0.0030
    80        0.5936             nan     0.1000   -0.0014
   100        0.5608             nan     0.1000   -0.0015
   120        0.5330             nan     0.1000   -0.0028
   140        0.5041             nan     0.1000   -0.0021
   160        0.4808             nan     0.1000   -0.0018
   180        0.4568             nan     0.1000   -0.0018
   200        0.4367             nan     0.1000   -0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3243             nan     0.1000    0.0222
     2        1.2835             nan     0.1000    0.0186
     3        1.2419             nan     0.1000    0.0198
     4        1.2097             nan     0.1000    0.0155
     5        1.1798             nan     0.1000    0.0129
     6        1.1493             nan     0.1000    0.0130
     7        1.1257             nan     0.1000    0.0108
     8        1.1049             nan     0.1000    0.0083
     9        1.0864             nan     0.1000    0.0070
    10        1.0697             nan     0.1000    0.0061
    20        0.9448             nan     0.1000    0.0030
    40        0.8230             nan     0.1000    0.0004
    60        0.7758             nan     0.1000   -0.0001
    80        0.7469             nan     0.1000   -0.0011
   100        0.7301             nan     0.1000   -0.0003
   120        0.7162             nan     0.1000   -0.0001
   140        0.7070             nan     0.1000   -0.0011
   160        0.7001             nan     0.1000   -0.0002
   180        0.6919             nan     0.1000   -0.0007
   200        0.6850             nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3071             nan     0.1000    0.0317
     2        1.2511             nan     0.1000    0.0242
     3        1.2027             nan     0.1000    0.0234
     4        1.1512             nan     0.1000    0.0243
     5        1.1157             nan     0.1000    0.0171
     6        1.0780             nan     0.1000    0.0187
     7        1.0557             nan     0.1000    0.0119
     8        1.0282             nan     0.1000    0.0134
     9        0.9994             nan     0.1000    0.0121
    10        0.9781             nan     0.1000    0.0096
    20        0.8384             nan     0.1000    0.0027
    40        0.7386             nan     0.1000    0.0008
    60        0.6907             nan     0.1000   -0.0007
    80        0.6605             nan     0.1000   -0.0002
   100        0.6370             nan     0.1000   -0.0009
   120        0.6159             nan     0.1000   -0.0012
   140        0.5980             nan     0.1000   -0.0023
   160        0.5808             nan     0.1000   -0.0014
   180        0.5659             nan     0.1000   -0.0023
   200        0.5548             nan     0.1000   -0.0017

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.2913             nan     0.1000    0.0400
     2        1.2281             nan     0.1000    0.0282
     3        1.1731             nan     0.1000    0.0261
     4        1.1302             nan     0.1000    0.0225
     5        1.0858             nan     0.1000    0.0204
     6        1.0489             nan     0.1000    0.0147
     7        1.0142             nan     0.1000    0.0170
     8        0.9922             nan     0.1000    0.0089
     9        0.9707             nan     0.1000    0.0094
    10        0.9429             nan     0.1000    0.0120
    20        0.8085             nan     0.1000    0.0025
    40        0.6978             nan     0.1000   -0.0011
    60        0.6470             nan     0.1000   -0.0012
    80        0.6091             nan     0.1000   -0.0009
   100        0.5716             nan     0.1000   -0.0019
   120        0.5400             nan     0.1000   -0.0009
   140        0.5152             nan     0.1000   -0.0013
   160        0.4928             nan     0.1000   -0.0006
   180        0.4730             nan     0.1000   -0.0014
   200        0.4520             nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.3077             nan     0.1000    0.0320
     2        1.2357             nan     0.1000    0.0320
     3        1.1874             nan     0.1000    0.0223
     4        1.1308             nan     0.1000    0.0243
     5        1.0861             nan     0.1000    0.0196
     6        1.0533             nan     0.1000    0.0162
     7        1.0249             nan     0.1000    0.0116
     8        0.9952             nan     0.1000    0.0136
     9        0.9701             nan     0.1000    0.0099
    10        0.9446             nan     0.1000    0.0093
    20        0.8099             nan     0.1000    0.0030
    40        0.7059             nan     0.1000    0.0000
    60        0.6590             nan     0.1000   -0.0011
    80        0.6192             nan     0.1000   -0.0009
   100        0.5842             nan     0.1000   -0.0014</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Details</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>tree_fit3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stochastic Gradient Boosting 

735 samples
 17 predictor
  2 classes: '0', '1' 

Pre-processing: centered (17), scaled (17) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 661, 661, 662, 662, 662, 661, ... 
Resampling results across tuning parameters:

  interaction.depth  n.trees  Accuracy   Kappa    
  1                   25      0.8112813  0.6181390
  1                   50      0.8153911  0.6263761
  1                  100      0.8194882  0.6347369
  1                  200      0.8339830  0.6642128
  2                   25      0.8185931  0.6314508
  2                   50      0.8254122  0.6456407
  2                  100      0.8335013  0.6623668
  2                  200      0.8308358  0.6573588
  3                   25      0.8212341  0.6363741
  3                   50      0.8303300  0.6552613
  3                  100      0.8349087  0.6652100
  3                  200      0.8276206  0.6502312

Tuning parameter 'shrinkage' was held constant at a value of 0.1

Tuning parameter 'n.minobsinnode' was held constant at a value of 10
Accuracy was used to select the optimal model using the largest value.
The final values used for the model were n.trees = 100, interaction.depth =
 3, shrinkage = 0.1 and n.minobsinnode = 10.</code></pre>
</div>
</div>
<p>Evaluating <code>tree_fit3</code> model performance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Predictions</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>pred_tree3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_fit3,<span class="at">newdata =</span> test)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Metrics</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_tree3,test<span class="sc">$</span>HeartDisease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 65 12
         1 17 89
                                          
               Accuracy : 0.8415          
                 95% CI : (0.7804, 0.8912)
    No Information Rate : 0.5519          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6778          
                                          
 Mcnemar's Test P-Value : 0.4576          
                                          
            Sensitivity : 0.7927          
            Specificity : 0.8812          
         Pos Pred Value : 0.8442          
         Neg Pred Value : 0.8396          
             Prevalence : 0.4481          
         Detection Rate : 0.3552          
   Detection Prevalence : 0.4208          
      Balanced Accuracy : 0.8369          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
</section>
<section id="wrap-up" class="level3">
<h3 class="anchored" data-anchor-id="wrap-up">Wrap Up</h3>
<p>The best model performance on test set based on accuracy = 0.847 is observed in two models <code>knn_fit</code> (KNN Model) and <code>tree_fit2</code> (Random Forest Model).</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>